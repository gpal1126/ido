<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">

<title>설문조사표만들기2</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<link rel="stylesheet" href="/css/web/service/survey/survey_write.css" />
<script type="text/javascript" src="http://code.jquery.com/jquery-1.11.1.js"></script>
<script type="text/javascript" src="/js/web/common/getUrlParameter.js"></script>

<!-- 이미지 Crop -->
<link rel="stylesheet" href="/css/web/mobile/survey/assets/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/web/mobile/survey/assets/css/tether.min.css">
<link rel="stylesheet" href="/css/web/mobile/survey/assets/css/bootstrap.min.css">
<link rel="stylesheet" href="/css/web/mobile/survey/dist/cropper.css">
<link rel="stylesheet" href="/css/web/mobile/survey/css/main.css">
<!-- 이미지 Crop -->

<!-- 텍스트/이미지 타입 탭 css -->
<link rel="stylesheet" type="text/css" href="/css/web/builder/survey/m_tabs.css" />
<!-- 설문조사 css -->
<link rel="stylesheet" type="text/css" href="/css/web/builder/survey/m_survey_320.css" media="screen and (min-width:320px) and (max-width:371px)"/>
<link rel="stylesheet" type="text/css" href="/css/web/builder/survey/m_survey.css" media="screen and (min-width:371px) and (max-width:440px)"/>
<link rel="stylesheet" type="text/css" href="/css/web/builder/survey/m_survey_1028.css" media="screen and (min-width:768px) and (max-width:1028px)"/>	<!-- ipad -->



<style type="text/css">
.wrap{
  width: 100%;
  height: 100%;
  position: fixed;
  left: 0;
  top:0;
  background-color: #363636;
  opacity: 1;
}

.additional_wrap{
  width: 100%;
  height: 100%;
  position: fixed;
  left: 0;
  top:0;
  background-color: #363636;
  opacity: 1;
  z-index: 5000;
}

.progress_wrap{
  width: 100%;
  height: 100%;
  position: fixed;
  left: 0;
  top:0;
  background-color: white;
  opacity: 0.9;
}

</style>
<script type="text/javascript">
//js getter/setter
function Value(val){
	var value=val;
	this.getValue = function(){
		return value;
	};
	
	this.setValue = function(val){
		value=val;
	};
}

function getUrlParameter(sParam){ //View에 URL에 접근하여 get parameter값을 가져옴
	var sPageURL = window.location.search.substring(1);
  	var sURLVariables = sPageURL.split('&');
  	for (var i = 0; i < sURLVariables.length; i++) {
    	var sParameterName = sURLVariables[i].split('=');
    	if (sParameterName[0] == sParam) {
      	return sParameterName[1];
    	}//if
  	}//for
}

$(function(){
	//$('#listBtn').css('display','none');
	//리스트 이동 버튼 
	$('#listBtn').click(function(){
		$('#listWrap').css('display','');
		//리스트 조회하기
		selectSurveyTitle();
	});
	
	//완료 버튼 클릭시 컨텐츠 리스트 화면으로 이동
	$('.surveyDiv .finish_btn').click(function(){
		if(confirm("컨텐츠관리 화면으로 이동하시겠습니까?") == true){
			location.href="/upload/m_builder_list";
		}else {
			return;
		}
	});
	
});



//설문조사 리스트 조회하기
function selectSurveyTitle(){
	$.ajax({
		//url : '/selectTempStore?surveyId='+$('#surveyId_title').val()+'',
		url : '/upload/listSurveySecondTitle?surveyId='+getUrlParameter('surveyId')+'',
		type : 'GET',
		success : function(data){
			console.log(data);
			//title 값 for
			for(var i in data.title){
				//i값 숫자로 변환
				i = parseInt(i);  
				
				//답변 타입 텍스트:1, 이미지:2
				var answerType = data.title[i].SURVEY_ANSWER_TYPE;
				
				//설문 유형 타입
				var surveyType = data.title[i].SURVEY_TYPE;
				var surveyTypeTxt = '';
				if(surveyType=='1'){
					surveyTypeTxt = '순위형';
				}else if(surveyType=='2'){
					surveyTypeTxt = '별점형';
				}else if(surveyType=='3'){
					surveyTypeTxt = '이중택일형';
				}else if(surveyType=='4'){
					surveyTypeTxt = '선택형';
				}else if(surveyType=='5'){
					surveyTypeTxt = '텍스트형';
				}//if
				
// 				//설문조사 조회 
// 			 	var selectSurvey = ''+
// 			 					   '<div id="surveyDiv'+i+'" style="border:0px solid #000;" class="survey_tb01">'+
// 			 					   		'<div class="delSurTypeDiv"><img class="deleteSurveyType'+i+'" id="deleteSurveyType'+(i+1)+'" src="/images/common/builder/survey/survey_list_closebt.gif" style="margin-right:5px;" onclick="delSurveyType('+i+','+data.title[i].SURVEY_TYPE_ID+')"></div>'+
// 				 					   	'<input type="hidden" id="surveyAnswerType'+(i+1)+'" name="surveyAnswerType" value="'+answerType+'">'+
// 										'<span id="surveyTypeIdSpan'+(i+1)+'"><input type="hidden" id="surveyTypeId'+(i+1)+'" name="surveyTypeId" value="'+data.title[i].SURVEY_TYPE_ID+'"/></span>'+
// 										'<div class="surveyTypeDiv"><span class="surveyTypeTxt">'+surveyTypeTxt+'</span></div>'+
// 										'<input type="hidden" id="surveyType'+(i+1)+'" name="surveyType" value="'+data.title[i].SURVEY_TYPE+'">'+
// 			  							'<div class="surveyTitleDiv">';
// 			 	if(surveyType=='2'){
// 			 		selectSurvey +=			'<div class="secSvyTitleDiv">'+
// 			 									'<img class="secSvyTitleImg" src="'+data.title[i]['SECOND_SURVEY_IMAGE_PATH']+'" id="secSvyTitleImg'+(i+1)+'"/>'+
// 			 								'</div>';
// 			 	}//if
// 			  	selectSurvey +=				'<span style="margin-left:20px;background:url(/images/common/builder/survey/circle_bullet.png) no-repeat; width:14px;height:14px;display: inline-block; overflow: hidden;vertical-align: middle;"></span>'+
// 			  								'<span class="titleSpan" id="titleSpan'+(i+1)+'" >'+data.title[i].SECOND_SURVEY_TITLE+'</span>'+
// 			  							'</div>'+
// 			  							'<div></div><br/>';
// 				var j=0;
// 				//contents 값 for
// 		  		for(j in data.reply[i]){
// 		  			j = parseInt(j);
// 					var img = data.reply[i][j]['SURVEY_IMAGE_PATH']; 
// 			  		selectSurvey +=	'<div class="contsDiv'+i+'" id="contsDiv'+(i+1)+'_'+(j+1)+'">'+
// 			  							'<input type="hidden" id="surveyContentsId'+(j+1)+'" name="surveyContentsId" value="'+data.reply[i][j]['SURVEY_CONTENTS_ID']+'">';
// 			  		if(answerType=='1'){
// 			  			selectSurvey +=	//'<div></div>'+
// 						  				'<div class="contsTxtDiv">'+
// 							  				'<span style="margin-left:25px;background:url(/images/common/builder/survey/reply_bullet.png) no-repeat; width:4px;height:4px; display:inline-block; overflow: hidden;vertical-align: middle;"></span>'+
// 							  				'<span class="contsTxtSpan" id="contentsSpan'+(i+1)+'_'+(j+1)+'" >'+data.reply[i][j]['SURVEY_CONTENTS']+'</span>'+
// 						  				'</div>';
// 			  		}
// 			  		if(answerType=='2'){
// 				  		selectSurvey +=	
// 							  			/* '<div class="delSurContsDiv"><img class="deleteConts'+i+'" id="deleteConts'+(i+1)+'_'+(j+1)+'" src="/images/common/builder/survey/delBtn.png" style="width:15px; height:15px;" onclick="delConts('+i+','+j+', '+data.reply[i][j]['SURVEY_CONTENTS_ID']+')"></div> '+ */
// 							  			'<div class="img_div" style="width:4.5%; height:39px; float:left; margin-left: 10px;">'+
// 							  				'<div class="img" id="img'+(i+1)+'_'+(j+1)+'" style="background: url('+data.reply[i][j]['SURVEY_CROP_IMAGE']+'); width:100%; height:100%; background-size: cover; background-position: 0px; background-repeat: no-repeat;"></div>'+
// 							  			'</div>'
// // 				  						'<img class="img" src="'+data.reply[i][j]['SURVEY_CROP_IMAGE']+'" id="img'+(i+1)+'_'+(j+1)+'" style="width:200px; height:160px;"/>'+
// 				  						/* '<div class="contsTxtDiv">'+
// 				  							'<span style="margin-left:25px;background:url(/images/common/builder/survey/reply_bullet.png) no-repeat; width:4px;height:4px;display: inline-block; overflow: hidden;vertical-align: middle;"></span>'+
// 				  							'<span class="contsTxtSpan" id="contentsSpan'+(i+1)+'_'+(j+1)+'" >'+data.reply[i][j]['SURVEY_CONTENTS']+'</span>'+
// 				  						'</div>'; */
// 				  						'';
// 			  		}//if			
// 			  						'</div>'; 
// 				}//for
		  	
// 		  		selectSurvey += '</div>';

				
				//설문조사 조회
				var listSurvey = '';
				
				listSurvey += ''+
								'<div class="survey_div" id="surveyDiv">'+
									'<input type="hidden" id="surveyAnswerType'+(i+1)+'" name="surveyAnswerType" value="'+answerType+'">'+
									'<input type="hidden" id="surveyTypeId'+(i+1)+'" name="surveyTypeId" value="'+data.title[i].SURVEY_TYPE_ID+'">'+
									'<input type="hidden" id="surveyType'+(i+1)+'" name="surveyType" value="'+data.title[i].SURVEY_TYPE+'">'+
									'<div class="conts_img_div">'+
									'';
									
									
				//$('#listDiv').append(listSurvey);
				var j=0;
 				//contents 값 for
 		  		for(j in data.reply[i]){
 		  			j = parseInt(j);
 		  			var contsImg = '';
 		  			listSurvey +=	'<div class="contsDiv'+i+'" id="contsDiv'+(i+1)+'_'+(j+1)+'" style="">'+
 			  							'<input type="hidden" id="surveyContentsId'+(j+1)+'" name="surveyContentsId" value="'+data.reply[i][j]['SURVEY_CONTENTS_ID']+'">';
 			  		if(answerType=='1'){
 			  			listSurvey +=	//'<div></div>'+
 						  				'<div class="contsTxtDiv">'+
 							  				'<span style="margin-left:25px;background:url(/images/common/builder/survey/reply_bullet.png) no-repeat; width:4px;height:4px; display:inline-block; overflow: hidden;vertical-align: middle;"></span>'+
 							  				'<span class="contsTxtSpan" id="contentsSpan'+(i+1)+'_'+(j+1)+'" >'+data.reply[i][j]['SURVEY_CONTENTS']+'</span>'+
 						  				'</div>';
 			  		}
 			  		if(answerType=='2'){
 			  			listSurvey +=	
 							  			/* '<div class="delSurContsDiv"><img class="deleteConts'+i+'" id="deleteConts'+(i+1)+'_'+(j+1)+'" src="/images/common/builder/survey/delBtn.png" style="width:15px; height:15px;" onclick="delConts('+i+','+j+', '+data.reply[i][j]['SURVEY_CONTENTS_ID']+')"></div> '+ */
 							  			'<div class="img_div">'+
 							  				'<div class="img" id="img'+(i+1)+'_'+(j+1)+'" style="background: url('+data.reply[i][j]['SURVEY_CROP_IMAGE']+'); width:100%; height:100%; background-size: cover; background-position: 0px; background-repeat: no-repeat;"></div>'+
 							  			'</div>'+
 				  						/* '<div class="contsTxtDiv">'+
 				  							'<span style="margin-left:25px;background:url(/images/common/builder/survey/reply_bullet.png) no-repeat; width:4px;height:4px;display: inline-block; overflow: hidden;vertical-align: middle;"></span>'+
 				  							'<span class="contsTxtSpan" id="contentsSpan'+(i+1)+'_'+(j+1)+'" >'+data.reply[i][j]['SURVEY_CONTENTS']+'</span>'+
 				  						'</div>'; */
 				  						'';
 			  		}//if			
 			  		listSurvey +=	'</div>';
 			  					
 				}//for
								
				listSurvey += 		'</div>';
				listSurvey +=		'<div class="conts_txt_div">'+
										'<div class="survey_type_div">'+
											'<div class="survey_type_btn">설문유형</div>'+
											'<span class="survey_type_txt">'+surveyTypeTxt+'</span>'+
										'</div>'+
										'<div class="survey_title_div">'+
											'<div class="survey_title_btn">제목</div>'+
											'<span class="survey_title">'+data.title[i].SECOND_SURVEY_TITLE+'</span>'+
										'</div>'+
									'</div>';
									
				listSurvey += 	'</div>';
				
				$('#listDiv').append(listSurvey);
				//$('.conts_img_div').append(listSurvey);
 				
				//리스트 종료
		  		$('#makeq').on('click', '.close_btn', function(){
		  			$('.list_wrap').css('display','none');
		  			$('.list_wrap #listDiv').empty();
		  		});
		  		
				//설문조사 조회 html append
				//임시저장 wrap
				$('#surveyDiv'+i+'').wrap('<a href="#" id="atag'+i+'" onclick="unwrapFunc('+i+','+j+'); return false;" style="text-decoration:none;"></a>');
				
			}//for
				
		},//end success
		error : function(error){
			console.log(error);
		}
	});//end ajax
}

//surveyId 값
//var surveyId = getUrlParameter('surveyId');
var surveyId = getUrlParameter('surveyId');
console.log('surveyId::'+surveyId);

var btn1Cnt = 0;	//순위형 클릭수 선언
var btn2Cnt = 0;	//벌점형 클릭수 선언
var btn3Cnt = 0;	//택일형 클릭수 선언
var btn4Cnt = 0;	//선택형 클릭수 선언
var btn5Cnt = 0;	//텍스트형 클릭수 선언

var btn1Click = false;	//순위형 클릭 선언
var btn2Click = false;	//별점형 클릭 선언
var btn3Click = false;	//택일형 클릭 선언
var btn4Click = false;	//선택형 클릭 선언
var btn5Click = false;	//텍스트형 클릭 선언

var survey1 = false;	//텍스트 저장 버튼
var survey2 = false; 	//이미지 저장 버튼

//저장시 insertDiv 초기화 
function surveyBtn(){
	//설문조사 유형 클릭수 초기화
	btn1Cnt = 0;
	btn2Cnt = 0;
	btn3Cnt = 0;
	btn4Cnt = 0;
	btn5Cnt = 0;
	
	//설문조사 유형 클릭 유무 초기화
	btn1Click = false;
	btn2Click = false;
	btn3Click = false;
	btn4Click = false;
	btn5Click = false;
	
	//유형 선택 버튼 click 초기화
	$("#btn1").attr('onclick', '').unbind('click');
	$("#btn2").attr('onclick', '').unbind('click');
	$("#btn3").attr('onclick', '').unbind('click');
	$("#btn4").attr('onclick', '').unbind('click');
	$("#btn5").attr('onclick', '').unbind('click');
	$("#btn1").attr('onclick', 'button1()').bind('click');
	$("#btn2").attr('onclick', 'button2()').bind('click');
	$("#btn3").attr('onclick', 'button3()').bind('click');
	$("#btn4").attr('onclick', 'button4()').bind('click');
	$("#btn5").attr('onclick', 'button5()').bind('click');
	console.log('btn1Cnt:::::'+btn1Cnt);
	console.log('btn2Cnt:::::'+btn2Cnt);
	console.log('btn3Cnt:::::'+btn3Cnt);
	console.log('btn4Cnt:::::'+btn4Cnt);
	console.log('btn5Cnt:::::'+btn5Cnt);
	
	//이미지 배열 초기화
	imgArr = new Value();
	console.log(imgArr.getValue());
}

//텍스트/이미지 val 체크 함수
function valChkFunc(){
	//validation span 체크
	if(btn1Click==true || btn3Click==true || btn4Click==true ){
		imgValChk();
		return false;
	}else if(btn2Click==true){
		txtValChk();
		return false;
	}else if(btn5Click==true){
		console.log('텍스트형 val chk!!!!');
		txtValChk();
		return false;
	}//if
}

//텍스트/이미지 저장 btn Func
function saveBtnFunc(){
	//텍스트 서베이 저장 버튼 클릭시
	$('#survey1').on('click', function(){
		//순위형 validation 체크 span
		txtValChk();
		//설문조사 등록
		insertAjax();
	});
	
	//이미지 서베이 저장 버튼 클릭시
	$('#survey2').on('click', function(){
		console.log('저장클릭!!!!!');
		//순위형 validation 체크 span
		imgValChk();
		//설문조사 등록
		insertAjax();
	});
}

//팝업 close시 함수
function closePopFunc(){
	//설문조사 리스트 팝업 close
	//$( "#dialog-listSurvey" ).dialog('close');
	//설문조사 리스트 초기화
	$('#listDiv').empty();
	//등록 div 제거
	$('#insertDiv').remove();
	
	//유형선택 class 제거
	$('#makeq section.choiceType ul li a.crownOn').attr('class', 'crownOff');
	$('#makeq section.choiceType ul li a.starOn').attr('class', 'starOff');
	$('#makeq section.choiceType ul li a.choiceOn').attr('class', 'choiceOff');
	$('#makeq section.choiceType ul li a.numberOn').attr('class', 'numberOff');
	$('#makeq section.choiceType ul li a.textOn').attr('class', 'textOff');
	
	//답변추가 수 초기화
	contsAddBtnClickCnt = 0;
	
	//저장시 서베이 버튼과 insertDiv 초기화
	surveyBtn();
}

//팝업 reload 함수
function reloadFunc(){
	//팝업 close시 초기화
	closePopFunc();
	
	//리스트 버튼 보이게
	$('#listBtn').css('display', '');
	
	//답변 만들기 버튼 안보이게
	$('.make_answer').css('display', 'none');
	
}

//순위형/별점형/택일형/선택형/텍스트형 클릭시 func
function btnClickFunc(){
	//다른 버튼 클릭시 validation 체크
	$('#btn1').on('click', function(){
		//별점형 클릭시 체크
		if(btn1Cnt>0){
			alert('설문지를 먼저 작성해주세요.');
			
			//validation span 체크
			valChkFunc();
		}//if
	});
	$('#btn2').on('click', function(){
		//별점형 클릭시 체크
		if(btn2Cnt>0){
			alert('설문지를 먼저 작성해주세요.');
			
			//validation span 체크
			valChkFunc();
		}//if
	});
	$('#btn3').on('click', function(){
		//택일형 클릭시 체크
		if(btn3Cnt>0){
			alert('설문지를 먼저 작성해주세요.');
			
			//validation span 체크
			valChkFunc();
		}//if
	});
	$('#btn4').on('click', function(){
		//선택형 클릭시 체크
		if(btn4Cnt>0){
			alert('설문지를 먼저 작성해주세요.');
			
			//validation span 체크
			valChkFunc();
		}//if
	});
	$('#btn5').on('click', function(){
		//텍스트형 클릭시 체크
		if(btn5Cnt>0){
			alert('설문지를 먼저 작성해주세요.');
			
			//validation span 체크
			valChkFunc();
		}//if
	});
}

//양자택일형 클릭
function button1(){
	console.log('양자택일');
	$('.answer_type_wrap_contents #btn1').attr('class','eitherOn');
	$('.answer_type_wrap_contents #btn2').attr('class','singleOff');
	$('.answer_type_wrap_contents #btn3').attr('class','choiceOff');
	$('.answer_type_wrap_contents #btn4').attr('class','crownOff');
	$('.answer_type_wrap_contents #btn5').attr('class','starOff');
	
	btn1Click = true;
	
	//양자택일형 클릭수 증가
	btn1Cnt += 1;
	
	console.log('btn1 클릭수:'+btn1Cnt);
	console.log('btn2 클릭수:'+btn2Cnt);
	console.log('btn3 클릭수:'+btn3Cnt);
	console.log('btn4 클릭수:'+btn4Cnt);
	console.log('btn5 클릭수:'+btn5Cnt);
	$('#answer_type').val('choice');
}

//단수선택형
function button2(){
	
	$('.answer_type_wrap_contents #btn1').attr('class','eitherOff');
	$('.answer_type_wrap_contents #btn2').attr('class','singleOn');
	$('.answer_type_wrap_contents #btn3').attr('class','choiceOff');
	$('.answer_type_wrap_contents #btn4').attr('class','crownOff');
	$('.answer_type_wrap_contents #btn5').attr('class','starOff');
	
	btn2Click = true;
	
	//단수선택형 클릭수 증가
	btn2Cnt += 1;
	
	console.log('btn1 클릭수:'+btn1Cnt);
	console.log('btn2 클릭수:'+btn2Cnt);
	console.log('btn3 클릭수:'+btn3Cnt);
	console.log('btn4 클릭수:'+btn4Cnt);
	console.log('btn5 클릭수:'+btn5Cnt);
	$('#answer_type').val('single');
}

//복수선택형
function button3(){
	
	$('.answer_type_wrap_contents #btn1').attr('class','eitherOff');
	$('.answer_type_wrap_contents #btn2').attr('class','singleOff');
	$('.answer_type_wrap_contents #btn3').attr('class','choiceOn');
	$('.answer_type_wrap_contents #btn4').attr('class','crownOff');
	$('.answer_type_wrap_contents #btn5').attr('class','starOff');
	
	btn3Click = true;
	
	//복수선택형 클릭수 증가
	btn3Cnt += 1;
	console.log('btn1 클릭수:'+btn1Cnt);
	console.log('btn2 클릭수:'+btn2Cnt);
	console.log('btn3 클릭수:'+btn3Cnt);
	console.log('btn4 클릭수:'+btn4Cnt);
	console.log('btn5 클릭수:'+btn5Cnt);
	
	$('#answer_type').val('select');
	/* //리스트 버튼 숨김
	$('#listBtn').css('display','none');
	
	
	if( $('.insertBtn').hasClass('insertBtn') == true ){
		alert('설문지를 먼저 작성해주세요.');
	}else {
		//선택형 클릭시 유형 선택 class 주기
		$('#btn1').attr('class','crownOff');
		$('#btn2').attr('class','starOff');
		$('#btn3').attr('class','choiceOn');
		$('#btn4').attr('class','numberOff');
		//div 보이기
		$('.footer').before('<div id="insertDiv"></div>');
	} */
	
	//처음에 택일형 클릭하였을 때
	/* if(btn3Cnt==1){
		//순위형과 별점형 클릭수 0이여야 함
		if(btn1Cnt==0 && btn2Cnt==0 && btn4Cnt==0 && btn5Cnt==0){
			//div 보이기
			$('.footer').before('<div id="insertDiv"></div>');
			//택일형 클릭시 유형 선택 class 주기
			$('#btn3').attr('class','choiceOn');
			
			//질문, 답변 append하기
			btn3Txt();		
			
			//다른 버튼 클릭시 validation 체크 func
			btnClickFunc()
			
			//텍스트 서베이 저장 버튼 클릭시
			$('#survey1').on('click', function(){
				//validation 체크 span
				txtValChk();
				//설문조사 등록
				insertAjax();
			});
			
			//이미지 서베이 저장 버튼 클릭시
			$('#survey2').on('click', function(){
				//validation 체크 span
				imgValChk();
				//설문조사 등록
				insertAjax();
			});
			
			//취소 버튼
			$('#cancel1').on('click', function(){
				//초기화 
				reloadFunc();
				//location.reload();
			});
			
			$('#cancel2').on('click', function(){
				console.log('택일형 취소?')
				//초기화 
				reloadFunc();
				//location.reload();
			});
		}//if
	} */
}

//순위형
function button4(){
	
	$('.answer_type_wrap_contents #btn1').attr('class','eitherOff');
	$('.answer_type_wrap_contents #btn2').attr('class','singleOff');
	$('.answer_type_wrap_contents #btn3').attr('class','choiceOff');
	$('.answer_type_wrap_contents #btn4').attr('class','crownOn');
	$('.answer_type_wrap_contents #btn5').attr('class','starOff');
	
	btn4Click = true;
	
	//순위형 클릭수 증가
	btn4Cnt += 1;
	
	console.log('btn1 클릭수:'+btn1Cnt);
	console.log('btn2 클릭수:'+btn2Cnt);
	console.log('btn3 클릭수:'+btn3Cnt);
	console.log('btn4 클릭수:'+btn4Cnt);
	console.log('btn5 클릭수:'+btn5Cnt);
	
	$('#answer_type').val('rank');
}

//별점채점형
function button5(){
	
	$('.answer_type_wrap_contents #btn1').attr('class','eitherOff');
	$('.answer_type_wrap_contents #btn2').attr('class','singleOff');
	$('.answer_type_wrap_contents #btn3').attr('class','choiceOff');
	$('.answer_type_wrap_contents #btn4').attr('class','crownOff');
	$('.answer_type_wrap_contents #btn5').attr('class','starOn');
	
	btn5Click = true;
	
	//별점채점형 클릭수 증가
	btn5Cnt += 1;
	
	console.log('btn1 클릭수:'+btn1Cnt);
	console.log('btn2 클릭수:'+btn2Cnt);
	console.log('btn3 클릭수:'+btn3Cnt);
	console.log('btn4 클릭수:'+btn4Cnt);
	console.log('btn5 클릭수:'+btn5Cnt);
	
	$('#answer_type').val('star');
}

/////////////////////////////////////////////////////////////////////////////

// + 버튼 클릭시 항목 추가
function addBtn(i){
	//항목 추가 버튼 클릭수 
	var addBtnCnt = 0;
	addBtnCnt = $('.add_btn').size()+1;
	console.log('addBtnCnt::'+addBtnCnt);
	if(addBtnCnt <= 5){
		//항목 추가 버튼 클릭수 만큼 append
		$('#starItem'+i).after('<span class="star_item" id="starItem'+addBtnCnt+'"><input type="text" id="evaluationItem'+addBtnCnt+'" name="evaluationItem"><img src="/img/mobile/builder/survey/reg_survey/plus_bt.png" class="add_btn" id="addBtn'+addBtnCnt+'" onclick="addBtn('+addBtnCnt+')"><img src="/img/mobile/builder/survey/reg_survey/minus_bt.png" class="remove_btn" id="removeBtn'+addBtnCnt+'" onclick="removeBtn('+addBtnCnt+')"></span>');
	}else {
		alert('항목을 더이상 추가할 수 없습니다.');
	}//if
}

// - 버튼 클릭시 항목 삭제
function removeBtn(i){
	//항목 삭제 버튼 개수
	var removeBtnCnt = $('.remove_btn').size();
	console.log('removeBtnCnt::'+removeBtnCnt);
	
	if(removeBtnCnt > 1){
		$('#starItem'+removeBtnCnt).remove();
	}else {
		alert('항목을 더이상 삭제할 수 없습니다.');
	}//if
}

//설문조사 임시저장한 수정 파일 불러오기
function unwrapFunc(i, j){
	i = parseInt(i);
	j = parseInt(j);
	console.log('i::::'+i);
	//a태그 클릭하면 text box로 val값 가져옴
	$('#surveyDiv'+i+'').unwrap();
	
	//unwrap되면 width 늘리기
	$('#surveyDiv'+i+'').css('width','900px');

	//중질문 삭제버튼 없애기
	$('#deleteSurveyType'+(i+1)+'').css('display','none');
	//중질문에 해당하는 컨텐츠 삭제 버튼 없애기
	$('.deleteConts'+i+'').css('display','none');
	
	//별점형일 경우 중질문 이미지 수정
	if($('#surveyType'+(i+1)+'').val()=='2'){
		console.log('별점형입니다~');
		$('#secSvyTitleImg'+(i+1)+'').before('<input type="file" id="secSvyTitleUpload'+(i+1)+'"name="secSvyTitleUpload" >');
		readSvyTitleImg(i);
	}//if
	
	// 텍스트/이미지별 조건 수정//////////////
	if($('#surveyAnswerType'+(i+1)+'').val()=='1'){
		//title span -> text box로 변경
		$('#titleSpan'+(i+1)+'').wrap('<input type="text" id="secondSurveyTitle'+(i+1)+'" name="secondSurveyTitle" value="'+$('#titleSpan'+(i+1)+'').text()+'" placeholder="질문을 입력해주세요.">');
		
		//contents span -> text box로 변경
		for(var contsIdx=0; contsIdx<=j; contsIdx++){
			//surveyType 값 선언
			var surveyTypeVal = $('#surveyDiv'+i+' input[name="surveyType"]').val();
			
			//surveyType이 1(순위형)/4(선택형)/5(텍스트형)일 때 
			$('#contentsSpan'+(i+1)+'_'+(contsIdx+1)+'').wrap('<span id="txtContsDiv'+(contsIdx+1)+'"><input type="text" id="surveyContents'+(i+1)+'_'+(contsIdx+1)+'" name="surveyContents" value="'+$('#contentsSpan'+(i+1)+'_'+(contsIdx+1)+'').text()+'" placeholder="내용을 입력해주세요."></span>');
			if(surveyTypeVal=='1' || surveyTypeVal=='4' || surveyTypeVal=='5'){
				$('#surveyContents'+(i+1)+'_'+(contsIdx+1)+'').after('<input type="button" class="addBtn'+i+'" id="addBtn'+(contsIdx+1)+'" onclick="addBtn('+i+','+contsIdx+')"><input type="button" class="removeBtn'+i+'" id="removeBtn'+(contsIdx+1)+'" onclick="removeBtn('+i+','+contsIdx+')"></div><div></div>');
			}else if(surveyTypeVal=='2'){//surveyType이 2(별점형)일 때
				$('#surveyContents'+(i+1)+'_'+(contsIdx+1)+'').after('<input type="button" class="addBtn'+i+'" id="addBtn'+(contsIdx+1)+'" onclick="addBtn('+i+','+contsIdx+')"><input type="button" class="removeBtn'+i+'" id="removeBtn'+(contsIdx+1)+'" onclick="removeBtn('+i+','+contsIdx+')"><input type="button" class="gradeBtn'+i+'" id="gradeBtn'+(contsIdx+1)+'" onclick="gradeBtn()"></div><div></div>');
			}else if(surveyTypeVal=='3'){//surveyType이 3(택일형)일 때
				//$('#surveyContents'+(i+1)+'_'+(contsIdx+1)+'').after('<input type="button" class="fileBtn'+i+'" id="fileBtn'+(contsIdx+1)+'" value="(#)" onclick="fileBtn('+i+','+contsIdx+')"></div><div></div>');
				//alert('택일형!!');				
			}//if
			//$('#surveyContents'+(i+1)+'_'+(j+1)+'').after('<input type="button" id="addBtn'+(i+1)+'_'+(j+1)+'" value="(+)" onclick="addBtn('+i+','+j+')"><input type="button" id="removeBtn'+(i+1)+'_'+(j+1)+'" value="(-)" onclick="removeBtn('+i+')"><div></div>');
		}//for
	}else if($('#surveyAnswerType'+(i+1)+'').val()=='2'){
		$('#titleSpan'+(i+1)+'').wrap('<input type="text" id="secondSurveyTitle'+(i+1)+'" name="secondSurveyTitle" value="'+$('#titleSpan'+(i+1)+'').text()+'" placeholder="질문을 입력해주세요.">');
		$('#secondSurveyTitle'+(i+1)+'').after('<input type="button" class="addConts'+i+'" id="addConts1" onclick="contsAddBtn('+i+','+j+')">');
		for(var contsIdx=0; contsIdx<=j; contsIdx++){
			var contsId = $('#surveyDiv'+i+' #surveyContentsId'+(contsIdx+1)+'').val();
			//답변 이미지 파일 업로드 append
			$('#img'+(i+1)+'_'+(contsIdx+1)+'').before('<input type="file" id="surveyImagePath'+(i+1)+'_'+(contsIdx+1)+'" name="surveyImagePath" >');
			//title span -> text box로 변경
			$('#contentsSpan'+(i+1)+'_'+(contsIdx+1)+'').wrap('<span id="txtContsDiv'+(contsIdx+1)+'"><input type="text" id="surveyContents'+(i+1)+'_'+(contsIdx+1)+'" name="surveyContents" value="'+$('#contentsSpan'+(i+1)+'_'+(contsIdx+1)+'').text()+'" placeholder="내용을 입력해주세요."></span>');
		}//for
		
		//기존 이미지 수정시 읽어오기 
		readImg(i);
	}//if
	
	//임시 저장 버튼 
	$('#surveyDiv'+i+'').append('<div style="text-align:right;"><input type="button" class="tempStore" id="tempStore'+i+'" onclick="tempStore('+i+', '+j+')"/></div>');
	
	//surveyType 값 선언
	var surveyTypeVal = $('#surveyDiv'+i+' input[name="surveyType"]').val();
	
	var surveyAnswerTypeVal = $('#surveyDiv'+i+' input[name="surveyAnswerType"]').val();
	
	//btn1, btn2, btn3 이벤트 합친거
	for(var btnId=1; btnId<=3; btnId++){
		$('#btn'+btnId+'').click(function(){
			//validation 체크
			if(surveyAnswerTypeVal=='1'){
				txtValChk();
			}else if(surveyAnswerTypeVal=='2'){
				imgValChk();
			}//if
			
			//임시저장 버튼이 있으면
			if($('input[id*="tempStore"]').val()!=undefined){
				//새로 저장 div 제거
				$('#insertDiv').remove();
				
				alert('먼저 임시저장을 해주세요.');
				return false;
			}
			
			//질문txt와 내용1txt 내용2txt 모두 값이 있으면 db에 저장
			/*
			if($('input[name="secondSurveyTitle"]').val()!='' && $('#surveyContents'+(i+1)+'_'+1+'').val()!='' && $('#surveyContents'+(i+1)+'_'+2+'').val()!==''){
				//설문조사 유형 id 선언
				var surveyTypeId = $('#surveyTypeId'+(i+1)).val();
				
				//FormData 선언
				var fd = new FormData();
				
				//해당 div의 필드 값 뽑아오기
				var data = $('#surveyDiv'+i+' input[type="text"]').serialize();
				//contentsId 필드 값들 가져오기
				var contsId = $('#surveyDiv'+i+' input[name="surveyContentsId"]').serialize();
				
				
				//모든 데이터 append
				fd.append('data', data);
				//ContentsId val 값들 append
				fd.append('contsId', contsId);
				
				$.ajax({
					url : '/tempStore/'+surveyTypeId,
					data : fd,
					type : 'POST',
					processData : false,
					contentType : false,
					success : function(data){
						alert('임시 저장되었습니다.');
						console.log(data);
						
						//location.href='/views/surveySecondTitleForm?surveyId='+$('#surveyId').val();
					}
				});//end ajax
			}//if
			*/
		});
	}//for
}

//탭 형식 
function tabsFunc(){
	$(".tab_content").hide();
    $(".tab_content:first").show();

    $("ul.tabs li").click(function (e) {
        $("ul.tabs li").removeClass("active").css("color", "#333");
        //$(this).addClass("active").css({"color": "darkred","font-weight": "bolder"});
        $(this).addClass("active").css("color", "#fafafa");
        $(".tab_content").hide();
        var activeTab = $(this).attr("rel");
        $("#" + activeTab).fadeIn()
    });
}
//////////////////////////////////////////////////

//파일 -> 답변추가로 버튼명 변경
function fileBtnChg(){
	//순위형/별점형일 때
	if( btn1Click==true || btn2Click==true ){
		$('#fileBtn').click(function(e){
			e.preventDefault();
			$('#surveyImagePath').click();
		});
		//input type=file 숨기기
		$('#surveyImagePath').css('display', 'none');
		
	}else if(btn3Click==true){ // 택일형일 때
		$('input:radio[name="choice"]').on('click',function(){
			
			//file버튼 수
			var fileBtnCnt = $('.fileBtn').size();
			for(var i=1; i<=fileBtnCnt; i++){
				
				$('#fileBtn'+(i)+'').click(function(e){
					e.preventDefault();
					$('#surveyImagePath'+(i)+'').click();

				//input type=file 숨기기
				$('#surveyImagePath'+(i)+'').css('display', 'none');
				});
				
			}//for
		});
	}//if
}
//////////////////////////////////////////////////
function readSvyTitleImg(i){
	if($('#insertDiv').val()!=undefined){	//새로 등록할 때
		if(btn2Click==true){	//별점형일 때
			
			/* 
			//텍스트탭일 경우
			//설문title 이미지를 클릭하면 
			$('#tab1 #secSvyTitleImg').click(function(e){
				e.preventDefault();
				$('#tab1 #secSvyTitleUpload').click();
			});
			
			//surveyTitle 업로드 버튼 숨김
			$('#tab1 #secSvyTitleUpload').css('display','none');
			
			$('#tab1 #secSvyTitleUpload').change(function(){
				if(this.files && this.files[0]){
					//확장자 구분
					switch(this.files[0].name.substring(this.files[0].name.lastIndexOf('.') + 1).toLowerCase()){
				        case 'jpg': case 'png': case 'jpeg':
				            break;
				        case 'gif':
				        	alert('GIF 이미지는 사용하실 수 없습니다.');
				        	return false;
				        	//break;
				        default:
				            $(this).val('');
				            // error message here
				            alert("이미지 파일이 아닙니다.");
				            break;
				    }//switch
					
					var reader = new FileReader();
					
					reader.onload = function(e){
						
						$('#tab1 .secSvyTitleDiv').css('display','inline-block');
						$('#tab1 .secSvyTitleDiv #secSvyTitleImg').attr('src', e.target.result);
					}
					reader.readAsDataURL(this.files[0]);
				}//if
			});
			 */
			
			//이미지탭일 경우
			//설문title 이미지를 클릭하면 
			$('#secSvyTitleImg').click(function(e){
				e.preventDefault();
				$('#secSvyTitleUpload').click();
			});
			
			//surveyTitle 업로드 버튼 숨김
			$('#secSvyTitleUpload').css('display','none');
			
			$('#secSvyTitleUpload').change(function(){
				if(this.files && this.files[0]){
					//확장자 구분
					switch(this.files[0].name.substring(this.files[0].name.lastIndexOf('.') + 1).toLowerCase()){
						case 'jpg': case 'png': case 'jpeg':
				            break;
				        case 'gif':
				        	alert('GIF 이미지는 사용하실 수 없습니다.');
				        	return false;
				        	//break;
				        default:
				            $(this).val('');
				            // error message here
				            alert("이미지 파일이 아닙니다.");
				            break;
				    }//switch
					
					var reader = new FileReader();
					
					reader.onload = function(e){
						$('.secSvyTitleDiv #secSvyTitleImg').attr('src', e.target.result);
					}
					reader.readAsDataURL(this.files[0]);
				}//if
			});
		}
	}else {//수정할 때 
		
		console.log($('#secSvyTitleImg'+(i+1)+'').attr('id'));
		//설문title 이미지를 클릭하면 
		$('#secSvyTitleImg'+(i+1)+'').click(function(e){
			e.preventDefault();
			$('#secSvyTitleUpload'+(i+1)+'').click();
		});
		
		//surveyTitle 업로드 버튼 숨김
		$('#secSvyTitleUpload'+(i+1)+'').css('display','none');
		
		$('#secSvyTitleUpload'+(i+1)+'').change(function(){
			/* if(this.files && this.files[0]){
				//확장자 구분
				switch(this.files[0].name.substring(this.files[0].name.lastIndexOf('.') + 1).toLowerCase()){
					case 'jpg': case 'png': case 'jpeg':
			            break;
			        case 'gif':
			        	alert('GIF 이미지는 사용하실 수 없습니다.');
			        	return false;
			        	//break;
			        default:
			            $(this).val('');
			            // error message here
			            alert("이미지 파일이 아닙니다.");
			            break;
			    }//switch
				
				var reader = new FileReader();
				
				reader.onload = function(e){
					
					$('#surveyDiv'+(i+1)+' .secSvyTitleDiv').css('display','inline-block');
					$('.secSvyTitleDiv #secSvyTitleImg'+(i+1)+'').attr('src', e.target.result);
				}
				reader.readAsDataURL(this.files[0]);
			 }//if
			 */
			
			/* ********** CROP ************* */
	      	$('.wrap').css('display','')
	      	$('.img-container').css('display','')
	      	
		      /* ********** CROP ************* */
		});
	}
}

//파일 이미지 불러오기 배열 선언 
var imgArr = new Value();
//답변 파일 업로드시 바로 이미지 출력
function readImg(k){
	console.log('찍형1')
	if($('#insertDiv').val()!=undefined){	//새로 등록할 때
		console.log('찍형2')
		//순위형/별점형/선택형 일 때
		if( btn1Click==true || btn2Click==true || btn4Click==true){
			console.log('찍형3')
			var contsDivCnt = $('.contsDiv').size();
			//var contsDivCnt = $('#answer_number').val();
			console.log('contsDivCnt::::::???'+contsDivCnt);
			for(var i=0; i<contsDivCnt; i++){
				i = parseInt(i);
				console.log('i::::'+(i+1));
				
				(function(i){
					//이미지 클릭시 파일 업로드
					$('#img'+(i+1)+'').click(function(e){
						console.log('i++111+++'+(i+1));
						
						e.preventDefault();
						console.log($(this).attr('id'));
						if('img'+(i+1)+'' == $(this).attr('id') ){
							console.log('i++2222+++'+(i+1));
							$('#surveyImagePath'+(i+1)+'').click();
						}
					});
				})(i);
				
				//input type=file 숨기기
				$('#surveyImagePath'+(i+1)+'').css('display', 'none');
				
				$('#surveyImagePath'+(i+1)+'').change(function(){
					/*for(var j=0; j<this.files.length; j++){
						//확장자 구분
						switch(this.files[j].name.substring(this.files[j].name.lastIndexOf('.') + 1).toLowerCase()){
					        case 'jpg': case 'png':
					            break;
					        case 'gif':
					        	alert('GIF 이미지는 사용하실 수 없습니다.');
					        	return false;
					        	//break;
					        default:
					            $(this).val('');
					            // error message here
					            alert("이미지 파일이 아닙니다.");
					            break;
					    }//switch
						if(this.files && this.files[j]){
							var reader = new FileReader();
							//현재 surveyImagePath 값 담음
							var imgPathId = $(this).attr('id');
								
								reader.onload = function(e){
									i = parseInt(i);
									
									var img = $('#img'+i+'');
									
									//현재값과 surveyImagePath의 값이 같으면
									if('surveyImagePath'+i+'' == imgPathId){
										img.css('display','inline-block');
										img.attr('src', e.target.result);
									}//if
								}
							reader.readAsDataURL(this.files[j]);
						}//if
					}//for*/
						
						/* ********** CROP ************* */
			      	$('.wrap').css('display','')
			      	$('.img-container').css('display','')
			      	
				      /* ********** CROP ************* */
				});
			}//for
		}else if(btn3Click==true){	//택일형 일 때
			var radioChkVal ='';
			$('input:radio[name="choice"]').on('click',function(){
				radioChkVal = $('input:radio[name="choice"]:checked').val();
				//int로 변환
				radioChkVal = parseInt(radioChkVal);
			
				
				for(var i=0; i<radioChkVal; i++){
					i = parseInt(i);
					
					//이미지 클릭시 파일 업로드
					$('#img'+(i+1)+'').click(function(e){
						var contsDivCnt = $('.contsDiv').size();
						for(var i=0; i<contsDivCnt; i++){
							e.preventDefault();
							if('img'+(i+1)+'' == $(this).attr('id') ){
								$('#surveyImagePath'+(i+1)+'').click();
							}//if
						}//for
					});
					
					//input type=file 숨기기
					$('#surveyImagePath'+(i+1)+'').css('display', 'none');
					
					$('#surveyImagePath'+(i+1)+'').change(function(){
						for(var j=0; j<this.files.length; j++){
							//확장자 구분
							switch(this.files[j].name.substring(this.files[j].name.lastIndexOf('.') + 1).toLowerCase()){
					        case 'jpg': case 'png': case 'jpeg':
					            break;
					        case 'gif':
					        	alert('GIF 이미지는 사용하실 수 없습니다.');
					        	return false;
					        	//break;
					        default:
					            $(this).val('');
					            // error message here
					            alert("이미지 파일이 아닙니다.");
					            break;
							}//switch
							
							if(this.files && this.files[j]){
								var reader = new FileReader();
								
								//현재 surveyImagePath 값 담음
								var imgPathId = $(this).attr('id');
								
								reader.onload = function(e){
									for(var no=1; no<=i; no++){
										var img = $('#img'+no+'');
										var contsDiv = $('#contsDiv'+no+'');
										
										if('surveyImagePath'+no+'' == imgPathId){
											contsDiv.css('display','inline-block');
											img.attr('src', e.target.result);
										}//if
									}//for
								}
								reader.readAsDataURL(this.files[j]);
							}//if
						}//for
					});
				}//for
			});	
		}//if
	}else {//수정일 때
		var contsDivCnt = $('#surveyDiv'+k+' .contsDiv'+k+'').size();
		//readImg 배열 선언
		var readImgArr = new Array();
		for(var i=0; i<contsDivCnt; i++){
			
			//이미지 클릭시 파일 업로드
			$('#img'+(k+1)+'_'+(i+1)+'').click(function(e){
				for(var i=0; i<contsDivCnt; i++){
					console.log(i);
				
					e.preventDefault();
					console.log($(this).attr('id'));
					if('img'+(k+1)+'_'+(i+1)+'' == $(this).attr('id') ){
						$('#surveyImagePath'+(k+1)+'_'+(i+1)+'').click();
					}//if
				}//for
			});
			
			//input type=file 숨기기
			$('#surveyImagePath'+(k+1)+'_'+(i+1)+'').css('display', 'none');
			
			$('#surveyImagePath'+(k+1)+'_'+(i+1)+'').change(function(){
				
				//conts id, img, 내용들의 값 선언
				var conts = $(this).parents().attr('id');
				//conts 내용들을 담음
				readImgArr.push(conts);
				console.log(readImgArr);
				
				//이미지 배열 setter
				imgArr.setValue(readImgArr);
				
				for(var j=0; j<this.files.length; j++){
					//확장자 구분
					switch(this.files[j].name.substring(this.files[j].name.lastIndexOf('.') + 1).toLowerCase()){
				        case 'jpg': case 'png':
				            break;
				        case 'gif':
				        	alert('GIF 이미지는 사용하실 수 없습니다.');
				        	return false;
				        	//break;
				        default:
				            $(this).val('');
				            // error message here
				            alert("이미지 파일이 아닙니다.");
				            break;
				    }//switch
					if(this.files && this.files[j]){
						var reader = new FileReader();
						//현재 surveyImagePath 값 담음
						var imgPathId = $(this).attr('id');
							
						reader.onload = function(e){
							i = parseInt(i);
							//현재값과 surveyImagePath의 값이 같으면
							//수정일 때 답변추가시 새 이미지 출력
							if('surveyImagePath'+(k+1)+'_'+i+'' == imgPathId){
								var img = $('#img'+(k+1)+'_'+i+'');
								
								img.css('display','inline-block');
								img.attr('src', e.target.result);
							}//if
							
							//수정 일 때 기존 이미지 수정시
							for(var l=0; l<i; l++){
								if('surveyImagePath'+(k+1)+'_'+l+'' == imgPathId){
									$('#img'+(k+1)+'_'+l+'').attr('src', e.target.result);
								}//if
							}//for
						}
						reader.readAsDataURL(this.files[j]);
					}//if
				}//for
			});
		}//for
	}//if
}

//답변추가 클릭수 선언
var contsAddBtnClickCnt = 0;

function contsAddBtn(i, j){//i=중질문 개수 j=질문당 컨텐츠 개수
	var contsHtml = '';
	
	if($('#insertDiv').val()!=undefined){	//새로 등록할 때
		
		$('nav').css('display','');	//저장/취소 버튼 보이게
		
		
		//답변추가 클릭수 증가
		//contsAddBtnClickCnt += 1;		
		//$('#clickCount').val(contsAddBtnClickCnt);
		
		//var contsDivCnt = $('.contsDiv').size();
		
		//no에 다시 담음
		//var no = contsAddBtnClickCnt;
		var no = $('.contsDiv').size()+1;
		
		//답변 개수 8개까지만 추가 가능
		if(no<9){
			//답변추가 클릭하면 컨텐츠 append
			//j = parseInt(j);
			contsHtml +=  '<div class="contsDiv" id="contsDiv'+no+'" >'+
							'<div class="delSurContsDiv"><img class="deleteConts'+i+'" id="deleteConts'+(i+1)+'_'+no+'" src="/images/common/builder/survey/delBtn.png" style="width:20px; height:20px;" onclick="delConts('+i+','+no+', null)"></div> '+
							'<input type="file" id="surveyImagePath'+no+'" name="surveyImagePath" style="display:none; ">'+
							'<div class="img_div" onclick="document.all.surveyImagePath'+no+'.click()"><img class="img" id="img'+no+'" alt="" src="/img/mobile/builder/survey/reg_survey/answer_n'+no+'.png"></div> '+
							'<div></div><span id="txtContsDiv'+no+'"><input type="text" id="surveyContents'+no+'" name="surveyContents" placeholder=""></span>'+
							'<div></div><span id="originContsDiv'+no+'"><input type="text" id="surveyOrigin'+no+'" name="surveyOrigin" placeholder=""></span>'+
							'<div></div><span id="linkAddrDiv'+no+'"><input type="text" id="surveyLinkAddr'+no+'" name="surveyLinkAddr" placeholder=""></span>'+
	   					  '</div>';
	   					  
			$('.insertBtn').before(contsHtml);
		}else {
			alert('더 이상 추가할 수 없습니다.');
		}//if
	}else {
		//img 개수 
		var imgCnt = $('#surveyDiv'+i+' .img').size();
		
		if(imgCnt<8){
			
		contsHtml +=  '<div class="contsDiv'+i+'" id="contsDiv'+(i+1)+'_'+(imgCnt+1)+'">'+
						'<input type="file" id="surveyImagePath'+(i+1)+'_'+(imgCnt+1)+'" name="surveyImagePath" >'+
						'<div class="img_div"><img class="img" id="img'+(i+1)+'_'+(imgCnt+1)+'" alt="" src=""></div> '+
						'<div></div><span id="txtContsDiv'+(imgCnt+1)+'"><span style="margin-left:25px;background:url(/images/common/builder/survey/reply_bullet.png) no-repeat; width:4px;height:4px;display: inline-block; overflow: hidden;vertical-align: middle;"></span><input type="text" id="surveyContents'+(i+1)+'_'+(imgCnt+1)+'" name="surveyContents" placeholder="내용을 입력해주세요."></span>'+
		 			  '</div>';
		  
		$('#contsDiv'+(i+1)+'_'+(imgCnt)+'').after(contsHtml);		
		}else {
			alert('더 이상 추가할 수 없습니다.');
		}//if
	}//if
	
	//파일 이미지 출력
	/* readImg(i); */
}

function delConts(i, j, contsId){
	var delContsCnt = $('.deleteConts'+i+'').size();
	console.log('delContsCnt::'+delContsCnt);
	console.log('i, j::'+i+', '+j);
	
	$('#deleteConts'+(i+1)+'_'+(j+1)+'').on('click', function(){
		$('#atag'+i+'').on('click',function(e){
			e.preventDefault();
		});
	});
	
	if(delContsCnt > 2){
		if($('#insertDiv').val()!=undefined){
			var contsId='';
			//contsDiv 삭제
			$('#contsDiv'+j+'').remove();
			
		}else {//기존 survey 수정
			var fd = new FormData();
			fd.append('contsId', contsId);
			
			//return false;
			if(confirm('삭제하시겠습니까?') == true){
				//해당 설문조사의 contsDiv 삭제
				$('#surveyDiv'+i+' #contsDiv'+(i+1)+'_'+(j+1)+'').remove();
				$.ajax({
					url : '/upload/deleteConts?contsId='+contsId,
					data : fd,
					type : 'POST',
					processData : false,
					contentType : false,
					success : function(){
						//location.href='/views/surveySecondTitleForm?surveyId='+$('#surveyId').val();
						alert('컨텐츠가 삭제되었습니다.');
					}//end success
				});//end ajax
				//reloadFunc();
				location.reload();
			} else {
				//reloadFunc();
				location.reload();
				return false;
			}
			
		}//if
	}else {
		alert('항목을 더이상 삭제할 수 없습니다.');
		//reloadFunc();
	}//if
	
}

function delSurveyType(i, surveyTypeId){
	//var delSurveyCnt = $('.deleteSurvey'+i+'').size();
	
	var fd = new FormData();
	fd.append('surveyTypeId', surveyTypeId);
	
	//return false;
	if(confirm('삭제하시겠습니까?') == true){
		//중질문삭제 버튼 제거 
		$('#deleteSurveyType'+(i+1)+'').remove();
		//해당 설문조사의 contsDiv 제거
		$('#surveyDiv'+i+'').remove();
		$.ajax({
			url : '/upload/deleteSurveyType?surveyTypeId='+surveyTypeId+'',
			data : fd,
			type : 'POST',
			processData : false,
			contentType : false,
			success : function(){
				//location.href='/views/surveySecondTitleForm?surveyId='+$('#surveyId').val();
			}//end success
		});//end ajax
		alert('설문조사가 삭제되었습니다.');
		//reloadFunc();
		location.reload();
	}else {
		//reloadFunc();
		location.reload();
		return false;
	}//if
}

//순위형/선택형  질문, 답변 append 합친거
function btnTxt(){
	if(typeof $('#secondSurveyTitle').val()=='undefined' && typeof $('#surveyContents1_1').val()=='undefined' && typeof $('#surveyContents1_2').val()=='undefined'){
		
		//i, j 선언
		var i=0;
		var j=0;
		
		var txtHtml = '';
		txtHtml += '<div id="txtDiv1">';
		txtHtml +=		'<input type="text" id="secondSurveyTitle1" name="secondSurveyTitle" placeholder="질문을 입력해주세요."><div></div>'+                                                                                                                                                                                                                               
						'<span id="txtContsDiv1">'+
							'<input type="text" id="surveyContents1" name="surveyContents" placeholder="내용을 입력해주세요.">'+
							'<input type="button" class="addBtn'+i+'" id="addBtn1" onclick="addBtn('+i+','+j+')">'+
							'<input type="button" class="removeBtn'+i+'" id="removeBtn1" onclick="removeBtn('+i+','+j+')">'+
							'';
		txtHtml +=			'<div></div>'+
						'</span>'+       
						'<span id="txtContsDiv2">'+
							'<input type="text" id="surveyContents2" name="surveyContents" placeholder="내용을 입력해주세요.">'+
							'<input type="button" class="addBtn'+i+'" id="addBtn2" onclick="addBtn('+i+','+j+')">'+
							'<input type="button" class="removeBtn'+i+'" id="removeBtn2" onclick="removeBtn('+i+','+j+')">';
		txtHtml	+=			'<div></div>'+
						'</span>'+
					'</div>';
		
		//텍스트형일 경우
		var html1 = '<section class="mquestion">'+
						'<div class="second_title"></div>'+
						txtHtml+
						'<div class="insertBtn">'+
							'<nav>'+
								'<ul>'+
									'<li>'+
										'<a href="#" class="saveSurvey" id="survey1"/></a>'+
									'</li>'+
									'<li>'+
										'<a href="#" class="cancelSurvey" id="cancel1"/></a>'+
									'</li>'+
								'</ul>'+
							'</nav>'+
						'</div>'+
					'</section>';
					
		/* var fileHtml = '';
		
		fileHtml += '<div id="txtDiv2">';
		fileHtml +=		'<input type="text" id="secondSurveyTitle2" name="secondSurveyTitle" placeholder="질문을 입력해주세요.">'+
						'<div class="addConts'+i+'" id="addConts1" onclick="contsAddBtn('+i+','+j+')"><img class="add_conts_img" src="/images/common/builder/m_survey/answer_add_bt.png"></div>'+
				   	'</div>';
		//순위형/선택형일 경우
		var html2 = '<section class="mquestion">'+
						'<div class="second_title"></div>'+
						'<div class="rank_select_type" id="container">'+
							fileHtml+
							'<div class="insertBtn">'+
								'<nav>'+
									'<ul>'+
										'<li>'+
											'<a href="#" class="saveSurvey" id="survey2"/></a>'+
										'</li>'+
										'<li>'+
											'<a href="#" class="cancelSurvey" id="cancel2"/></a>'+
										'</li>'+
									'</ul>'+
								'</nav>'+
							'</div>'+
						'</div>'+
					'</section>'; */
		 
		
		
		//순위형/선택형일 경우 append
		/* if(btn1Click==true || btn4Click==true){
			$('#insertDiv').append(html2);
		}else if(btn5Click==true){	//텍스트형일 경우 append
			$('#insertDiv').append(html1);
		} */
		
		//순위형/선택형일 경우
		if(btn1Click==true || btn4Click==true){
			//탭형식 
			tabsFunc();
			
			//파일 -> 답변추가로 버튼명 변경
			fileBtnChg();
			
			//파일 이미지 출력
			readImg(i);
		}//if
	}//if
}

//별점형 클릭시 질문, 내용 txt append하기
function btn2Txt(){
	if(typeof $('#secondSurveyTitle').val()=='undefined' && typeof $('#surveyContents1_1').val()=='undefined' && typeof $('#surveyContents1_2').val()=='undefined'){
		//i, j 선언
		var i=0;
		var j=0;
		
		var txtHtml = '';
		txtHtml +='<div class="star_type" id="txtDiv1">';
		
		txtHtml += 	'<input type="file" id="secSvyTitleUpload" name="secSvyTitleUpload"  >'+
					'<div class="secSvyTitleDiv" id="secSvyTitleDiv">'+
   						'<img class="secSvyTitleImg" id="secSvyTitleImg" alt="" src=""> '+
   					'</div>';
   					
		txtHtml += 	'<input type="text" id="secondSurveyTitle1" name="secondSurveyTitle" placeholder="질문을 입력해주세요.">';
		
		txtHtml += 	'<input type="text" id="surveyOrigin1" name="surveyOrigin" placeholder="출처를 입력해주세요."><div></div>';
		
		txtHtml += 	'<input type="text" id="surveyLinkAddr1" name="surveyLinkAddr" placeholder="링크주소를 입력해주세요."><div></div>';
		
   		txtHtml += 	'<span id="txtContsDiv1">'+
						'<input type="text" id="surveyContents1" name="surveyContents" placeholder="이미지 이름을 입력해주세요.">'+
						'<input type="button" class="addBtn'+i+'" id="addBtn1" onclick="addBtn('+i+','+j+')">'+
						'<input type="button" class="removeBtn'+i+'" id="removeBtn1" onclick="removeBtn('+i+','+j+')">'+
					'</span>';
		txtHtml +='</div>';			
					
		var html = '<section class="mquestion">'+
						'<div class="second_title"></div>'+
						'<div id="container">'+
							txtHtml+
							'<div class="insertBtn">'+
								'<nav>'+
									'<ul>'+
										'<li>'+
											'<a href="#" class="saveSurvey" id="survey1"/></a>'+
										'</li>'+
										'<li>'+
											'<a href="#" class="cancelSurvey" id="cancel1"/></a>'+
										'</li>'+
									'</ul>'+
								'</nav>'+
							'</div>'+
						'</div>'+
					'</section>';
					
   		$('#insertDiv').append(html);
   		
   		//surveyTitle 이미지 출력
   		readSvyTitleImg(i);
   		
   		//파일 -> 답변추가로 버튼명 변경
		fileBtnChg();
		
		//파일 이미지 출력
		readImg(i);
	}//if
}

//택일형 클릭시 질문, 내용 txt append하기
function btn3Txt(){
	if(typeof $('#secondSurveyTitle').val()=='undefined' && typeof $('#surveyContents1').val()=='undefined' && typeof $('#surveyContents2').val()=='undefined'){

		//i, j 선언
		var i=0, j=0;
		
		//radio 버튼 
		var choiceHtml = '<div class="choice_type">'+ 
							'<div class="line_bar"></div>'+
							'<div id="choiceDiv">'+
								'<div class="choice_type_txt"></div>'+
						  		'<div class="choice_radio">'+
						  			'<input type="radio" class="count_type" id="two" name="choice" value="2"><div class="chk_img two"></div><label for="two">2개</label>'+
						  			'<input type="radio" class="count_type" id="four" name="choice" value="4"><div class="chk_img four"></div><label for="four">4개</label>'+
						  			'<input type="radio" class="count_type" id="eight" name="choice" value="8"><div class="chk_img eight"></div><label for="eight">8개</label>'+
						  		'</div>'+
						 	'</div>'+
						 	'<div id="txtDiv">'+
						 	'</div>'+
						 '</div>';
						 
		//텍스트/이미지 탭				  
		$('#insertDiv').append('<div id="container">'+
									choiceHtml+
									'<div class="insertBtn">'+
										'<nav>'+
											'<ul>'+
												'<li>'+
													'<a href="#" class="saveSurvey" id="survey2"/></a>'+
												'</li>'+
												'<li>'+
													'<a href="#" class="cancelSurvey" id="cancel2"/></a>'+
												'</li>'+
											'</ul>'+
										'</nav>'+
									'</div>'+
								'</div>');
		
		$('input[name="choice"]').on("click", function(){
			//다른 라디오 버튼 클릭시 초기화 (txtDiv 하위요소 제거)
			$('#txtDiv').empty();
			
			//이미지탭 질문 txt
			var fileHtml = '<input type="text" id="secondSurveyTitle2" name="secondSurveyTitle" placeholder="질문을 입력해주세요."><div></div>';
			
			//이미지 탭 라디오버튼 체크
			//2개 택일형
			if($('input:radio[name="choice"]:checked').val() == '2'){
				//contents 내용
				for(var i=0; i<2; i++){
					// 이미지 파일 
					fileHtml += '<input type="file" id="surveyImagePath'+(i+1)+'" name="surveyImagePath"  >'+
								'<div class="contsDiv" id="contsDiv'+(i+1)+'">'+
						   			'<img class="img" id="img'+(i+1)+'" alt="" src=""> '+
									'<div></div><span id="txtContsDiv'+(i+1)+'"><input type="text" id="surveyContents'+(i+1)+'" name="surveyContents" placeholder="이미지 이름을 입력해주세요."></span>'+
									'<div></div><span id="originContsDiv'+(i+1)+'"><input type="text" id="surveyOrigin'+(i+1)+'" name="surveyOrigin" placeholder="출처를 입력해주세요."></span>'+
									'<div></div><span id="linkAddrDiv'+(i+1)+'"><input type="text" id="surveyLinkAddr'+(i+1)+'" name="surveyLinkAddr" placeholder="링크주소를 입력해주세요."></span>'+
						   		'</div>'; 
				}//for
			}else if($('input:radio[name="choice"]:checked').val()=='4'){//4개 택일형
				//contents 내용
				for(var i=0; i<4; i++){
					// 이미지 파일 
					fileHtml += '<input type="file" id="surveyImagePath'+(i+1)+'" name="surveyImagePath">'+
								'<div class="contsDiv" id="contsDiv'+(i+1)+'">'+
						   			'<img class="img" id="img'+(i+1)+'" alt="" src=""> '+
						   			'<div></div><span id="txtContsDiv'+(i+1)+'"><input type="text" id="surveyContents'+(i+1)+'" name="surveyContents" placeholder="이미지 이름을 입력해주세요."></span>'+
						   			'<div></div><span id="originContsDiv'+(i+1)+'"><input type="text" id="surveyOrigin'+(i+1)+'" name="surveyOrigin" placeholder="출처를 입력해주세요."></span>'+
						   			'<div></div><span id="linkAddrDiv'+(i+1)+'"><input type="text" id="surveyLinkAddr'+(i+1)+'" name="surveyLinkAddr" placeholder="링크주소를 입력해주세요."></span>'+
						   		'</div>'; 
				}//for
			}else if($('input:radio[name="choice"]:checked').val()=='8'){//8개 택일형
				//contents 내용
				for(var i=0; i<8; i++){
					// 이미지 파일 
					fileHtml += '<input type="file" id="surveyImagePath'+(i+1)+'" name="surveyImagePath">'+
								'<div class="contsDiv" id="contsDiv'+(i+1)+'">'+
						   			'<img class="img" id="img'+(i+1)+'" alt="" src=""> '+
						   			'<div></div><span id="txtContsDiv'+(i+1)+'"><input type="text" id="surveyContents'+(i+1)+'" name="surveyContents" placeholder="이미지 이름을 입력해주세요."></span>'+
						   			'<div></div><span id="originContsDiv'+(i+1)+'"><input type="text" id="surveyOrigin'+(i+1)+'" name="surveyOrigin" placeholder="출처를 입력해주세요."></span>'+
						   			'<div></div><span id="linkAddrDiv'+(i+1)+'"><input type="text" id="surveyLinkAddr'+(i+1)+'" name="surveyLinkAddr" placeholder="링크주소를 입력해주세요."></span>'+
						   		'</div>'; 
				}//for
			}//if
			
			//이미지탭 append
			$('#txtDiv').append(fileHtml);	
			
		});
		
		//탭형식 
		tabsFunc();
		
		//파일 -> 답변추가로 버튼명 변경
		fileBtnChg();
		
		//파일 이미지 출력
		readImg(i);
	}//if
}

//질문txt와 내용1txt, 내용2txt의 값 validation 체크
function txtValChk() {
	
	//탭 유무 chk
	if(btn1Click==true || btn2Click==true || btn3Click==true || btn4Click==true){//순위형/별점형/택일형/선택형일 경우 tab이 있음
		var tabChk = '#tab1 ';
	}else if(btn5Click==true){
		var tabChk = '';
	}//if
	
	console.log('tabChk:::'+tabChk);
	
	if($('#insertDiv').val()!=undefined){	//새로 등록할 때
		if(btn2Click==true){//별점형일 경우 중질문 이미지 val chk
			if($('#secSvyTitleImg').attr('src')==''){
				if($('#secSvyTitleImgChkSpan').val()==undefined){
					$('.secSvyTitleDiv').append('<div></div><span id="secSvyTitleImgChkSpan"> *등록해주세요.</span>')
				}//if
			}else {
				$('#secSvyTitleImgChkSpan').remove();
			}//if
		}//if
		//질문txt 값이 null이면
		if($('input[name="secondSurveyTitle"]').val()==''){
			//secondSurveyTitle validation span이 없으면 추가
			if($('#titleValChkSpan').val()==undefined){
				$('input[name="secondSurveyTitle"]').after('<div></div><span id="titleValChkSpan"> *질문을 입력해주세요.</span>');
			}//if
		}else {
			//질문txt 값이 있으면 validation span 제거
			$('#titleValChkSpan').remove();
		}//if
		
		if($('input[name="surveyOrigin"]').val()==''){	//출처 val chk
			//surveyOrigin validation span이 없으면 추가
			if($('#originValChkSpan').val()==undefined){
				$('input[name="surveyOrigin"]').after('<div></div><span id="originValChkSpan"> *출처를 입력해주세요.</span>');
			}//if
		}else {
			//출처txt 값이 있으면 validation span 제거
			$('#originValChkSpan').remove();
		}//if
		
		if($('input[name="surveyLinkAddr"]').val()==''){	//링크주소 val chk
			//surveyLinkAddr validation span이 없으면 추가
			if($('#linkAddrValChkSpan').val()==undefined){
				$('input[name="surveyLinkAddr"]').after('<div></div><span id="linkAddrValChkSpan"> *링크를 입력해주세요.</span>');
			}//if
		}else {
			//링크주소txt 값이 있으면 validation span 제거
			$('#linkAddrValChkSpan').remove();
		}//if
		
	}else {//수정할 때
		if(btn2Click==true){//별점형일 경우 추후 수정
			if($('#secSvyTitleImgChkSpan').val()==undefined){
				$('.secSvyTitleDiv').append('<span id="secSvyTitleImgChkSpan"> *등록해주세요.</span>')
			}
		}
		if($('input[name="secondSurveyTitle"]').val()==''){
			//secondSurveyTitle validation span이 없으면 추가
			if($('#titleValChkSpan').val()==undefined){
				$('input[name="secondSurveyTitle"]').after('<div></div><span id="titleValChkSpan"> *질문을 입력해주세요.</span>');
			}//if
		} else {
			//질문txt 값이 있으면 validation span 제거
			$('#titleValChkSpan').remove();
		}//if
	}//if
	var titleCnt = $('.titleSpan').size();
	
	//새로 insert일 때
	if($('#insertDiv').val()!=undefined){
		console.log('하하');
		for(var j=0; j<2; j++){
			if($('#surveyContents'+(j+1)+'').val()==''){
				//내용 validation span이 없으면 추가
				if($('#contsValChkSpan'+(j+1)+'').val()==undefined){
					$('#txtContsDiv'+(j+1)+'').after('<div></div><span class="contsValChkSpan" id="contsValChkSpan'+(j+1)+'"> *이미지 이름을 입력해주세요.</span><div></div>');
				}//if
			} else {
				//내용txt 값이 있으면 validation span 제거
				$('#contsValChkSpan'+(j+1)+'').remove();
			}//if
		}//for
	}else {//수정시
		//title for문
		for(var i=0; i<titleCnt; i++){
			//contents 2개만 validation 체크
			for(var j=0; j<2; j++){
				//int로 변환
				i = parseInt(i);
				j = parseInt(j);
				
				 //컨텐츠 값 선언
				var contsVal = $('#surveyDiv'+i+' #surveyContents'+(i+1)+'_'+(j+1)+'').val();
				
				//text box이면서 값이 null일때 
			 	if(typeof contsVal=='string' && (!contsVal || contsVal=='')){
					//내용 validation span이 없으면 추가
					if($('#surveyDiv'+(i)+' #contsValChkSpan'+(j+1)+'').val()==undefined){
						$('#surveyDiv'+(i)+' #removeBtn'+(j+1)+'').after('<div></div><span class="contsValChkSpan" id="contsValChkSpan'+(j+1)+'"> *내용을 입력해주세요.</span><div></div>');
					}//if
				}else if((typeof contsVal=='string' && (contsVal && contsVal!=''))) { //text box이면서 값이 null이 아닐 때
					//내용txt 값이 있으면 validation span 제거
					$('#surveyDiv'+(i)+' #contsValChkSpan'+(j+1)+'').remove();
				}//if
			}//for		
		}//for
	}//if
	
	//택일형 등록시 val chk
	if(btn3Click==true){
		var txtContsCnt = $('input[id*="surveyContents"]').size();
		for(var i=0; i<txtContsCnt; i++){
			if($('#surveyContents'+(i+1)+'').val()==''){
				//내용 validation span이 없으면 추가
				if($('#contsValChkSpan'+(i+1)+'').val()==undefined){
					$('#txtContsDiv'+(i+1)+'').after('<div></div><span class="contsValChkSpan" id="contsValChkSpan'+(i+1)+'"> *내용을 입력해주세요.</span><div></div>');
				}//if
			} else {
				//내용txt 값이 있으면 validation span 제거
				$('#contsValChkSpan'+(i+1)+'').remove();
			}//if					
		}//for
	}//if
}	
		
//이미지 validation 체크		
function imgValChk(){
	if($('#insertDiv').val()!=undefined){//새로 등록시 
		if(btn2Click==true){//별점형일 경우 중질문 이미지 val chk
			if($('#secSvyTitleImg').attr('src')==''){
				if($('#secSvyTitleImgChkSpan').val()==undefined){
					$('.secSvyTitleDiv').append('<div></div><span id="secSvyTitleImgChkSpan"> *중질문 이미지를 추가해주세요.</span>')
				}//if
			}else {
				$('#secSvyTitleImgChkSpan').remove();
			}//if
		}//if
		//질문txt 값이 null이면
		if($('input[name="secondSurveyTitle"]').val()==''){
			//secondSurveyTitle validation span이 없으면 추가
			if($('#titleValChkSpan').val()==undefined){
				if(btn1Click==true || btn2Click==true || btn4Click==true){
					$('#secondSurveyTitle2').after('<div></div><span id="titleValChkSpan"> *질문 제목을 입력해주세요</span>');
				}else if(btn3Click==true){
					$('#secondSurveyTitle2').after('<div></div><span id="titleValChkSpan"> *질문 제목을 입력해주세요</span>');
				}//if
			}//if
		}else {
			//질문txt 값이 있으면 validation span 제거
			$('#titleValChkSpan').remove();
		}//if
	}else {//수정시
		//질문txt 값이 null이면
		if($('input[name="secondSurveyTitle"]').val()==''){
			//secondSurveyTitle validation span이 없으면 추가
			if($('#titleValChkSpan').val()==undefined){
				console.log($('input[name="secondSurveyTitle"]').next());
				$('input[name="secondSurveyTitle"]').next().after('<div></div><span id="titleValChkSpan"> *질문 제목을 입력해주세요</span>');
				//$('input[name="secondSurveyTitle"]').after('<div></div><span id="titleValChkSpan"> 질문을 입력해주세요.</span>');
			}//if
		}else {
			//질문txt 값이 있으면 validation span 제거
			$('#titleValChkSpan').remove();
		}//if
	}//if	
	
	if($('#insertDiv').val()!=undefined){//새로 등록시
		//txt val chk
		for(var j=0; j<8; j++){
			/* if($('#surveyContents'+(j+1)+'').val()==''){
				//내용 validation span이 없으면 추가
				
				if($('#contsValChkSpan'+(j+1)+'').val()==undefined){
					$('#txtContsDiv'+(j+1)+'').after('<div></div><span class="contsValChkSpan" id="contsValChkSpan'+(j+1)+'"> *설명문을 입력해주세요.</span>');
					$('#surveyOrigin'+(j+1)+'').css('margin-top','0');//출처 input box css
				}//if
			} else {
				//내용txt 값이 있으면 validation span 제거
				$('#contsValChkSpan'+(j+1)+'').remove();
				$('#surveyOrigin'+(j+1)+'').css('margin-top','13px');//출처 input box css
			}//if */
			
			if($('#surveyOrigin'+(j+1)+'').val()==''){
				//내용 validation span이 없으면 추가
				
				if($('#originValChkSpan'+(j+1)+'').val()==undefined){
					$('#originContsDiv'+(j+1)+'').after('<div></div><span class="originValChkSpan" id="originValChkSpan'+(j+1)+'"> *출처를 입력해주세요.</span>');
					$('#surveyLinkAddr'+(j+1)+'').css('margin-top','0');//링크주소 input box css
				}//if
			} else {
				//내용txt 값이 있으면 validation span 제거
				$('#originValChkSpan'+(j+1)+'').remove();
				$('#surveyLinkAddr'+(j+1)+'').css('margin-top','13px');//링크주소 input box css
			}//if
			
			/* if($('#surveyLinkAddr'+(j+1)+'').val()==''){
				//내용 validation span이 없으면 추가
				
				if($('#linkAddrValChkSpan'+(j+1)+'').val()==undefined){
					$('#linkAddrDiv'+(j+1)+'').after('<div></div><span class="linkAddrValChkSpan" id="linkAddrValChkSpan'+(j+1)+'"> *링크주소를 입력해주세요.</span>');
				}//if
			} else {
				//내용txt 값이 있으면 validation span 제거
				$('#linkAddrValChkSpan'+(j+1)+'').remove();
			}//if */
		}//for
		
		//이미지 컨텐츠 등록시 img chk 
		var imgCnt = $('.img').size();
		console.log('imgCnt::'+imgCnt);
		for(var j=0; j<8; j++){
			console.log('j:::'+j);
			if( $('#img'+(j+1)+'').attr('src')=='' ){
				//img chk span이 없으면 추가
				if($('#imgChkSpan'+(j+1)+'').val()==undefined){
					//alert('이미지를 등록해주세요.');
					$('#img'+(j+1)+'').after('<div></div><span class="imgChkSpan" id="imgChkSpan'+(j+1)+'"> *등록해주세요.</span>');
					//$('.rank_select_type div[id*=contsDiv] .img').css('float','none');
					//$('.rank_select_type .img_div').css('float','left');
				}//if
			}else {
				//img가 있으면 img chk span 제거
				$('#imgChkSpan'+(j+1)+'').remove();
			}//if
		}//for
	}else {//수정시
		
		var titleCnt = $('.titleSpan').size();
		//title for문
		for(var i=0; i<titleCnt; i++){
			//contents validation 체크
			//컨텐츠 개수 선언
			var contsCnt = $('#surveyDiv'+i+' .contsDiv'+i+'').size();
			
			for(var j=0; j<contsCnt; j++){
				//int로 변환
				i = parseInt(i);
				j = parseInt(j);
			 	
				//surveyType 값 선언
				var surveyAnswerTypeVal = $('#surveyDiv'+i+' input[name="surveyAnswerType"]').val();
			 
				//text box이면서 값이 null일때 
				if($('#surveyDiv'+i+' #surveyContents'+(i+1)+'_'+(j+1)+'').val()==''){
					//내용 validation span이 없으면 추가
					if($('#surveyDiv'+i+' #contsValChkSpan'+(j+1)+'').val()==undefined){
						$('#surveyDiv'+i+' #txtContsDiv'+(j+1)+'').after('<div></div><span class="contsValChkSpan" id="contsValChkSpan'+(j+1)+'"> *내용을 입력해주세요.</span>');
						return false;
					}//if
				} else {
					//내용txt 값이 있으면 validation span 제거
					$('#surveyDiv'+i+' #contsValChkSpan'+(j+1)+'').remove();
				}//if
				
				//img가 없을 때 val chk
				if( $('#surveyDiv'+i+' #img'+(i+1)+'_'+(j+1)+'').attr('src')=='' ){
					//img chk span이 없으면 추가
					if($('#surveyDiv'+i+' #imgChkSpan'+(i+1)+'_'+(j+1)+'').val()==undefined){
						$('#surveyDiv'+i+' #img'+(i+1)+'_'+(j+1)+'').after('<div></div><span class="imgChkSpan" id="imgChkSpan'+(i+1)+'_'+(j+1)+'"> *이미지를 추가해주세요.</span>');
					}//if
				}else {
					//img가 있으면 img chk span 제거
					$('#surveyDiv'+i+' #imgChkSpan'+(i+1)+'_'+(j+1)+'').remove();
				}//if 
				
				/*
				//컨텐츠 값 선언
				var contsVal = $('#surveyDiv'+i+' #surveyContents'+(i+1)+'_'+(j+1)+'').val();
				console.log('contsVal:'+contsVal);
			 	if(typeof contsVal=='string' && (!contsVal || contsVal=='')){
					console.log(typeof $('#surveyContents'+(i+1)+'_'+(j+1)+'').val());
					console.log($('#surveyContents'+(i+1)+'_'+(j+1)+'').val());
					console.log($('#surveyContents'+(i+1)+'_'+(j+1)+''));
					console.log('i_j:'+(i+1)+'_'+(j+1));
					
					//내용 validation span이 없으면 추가
					if($('#surveyDiv'+i+' #contsValChkSpan'+(j+1)+'').val()==undefined){
						console.log('컨텐츠 val 체크!!!');
						$('#surveyDiv'+i+' #txtContsDiv'+(j+1)+'').after('<div></div><span class="contsValChkSpan" id="contsValChkSpan'+(j+1)+'"> 내용을 입력해주세요.</span>');
						console.log($('#surveyDiv'+i+' #txtContsDiv'+(j+1)+'').attr('id'));
						console.log($('#contsValChkSpan'+(j+1)+'').attr('id'));
					}//if
				}else if((typeof contsVal=='string' && (contsVal && contsVal!=''))) { //text box이면서 값이 null이 아닐 때
					//내용txt 값이 있으면 validation span 제거
					$('#surveyDiv'+i+' #contsValChkSpan'+(j+1)+'').remove();
				}//if
				*/
			}//for	
		}//for
	}//if
}		

//설문조사 insert ajax
function insertAjax(){
	console.log('인설트?????');
	
	//탭 유무 chk
	if(btn1Click==true || btn2Click==true || btn3Click==true || btn4Click==true){//순위형/별점형/택일형/선택형일 경우 tab이 있음
		var tabChk = '#tab1 ';
	}else if(btn5Click==true){
		var tabChk = '';
	}//if
	
	//택일형 등록시 val chk
	if(btn3Click==true){
		//택일형 radio chk
		RadioTxtChkVal = $('input:radio[name="choice"]:checked').val();
		//택일형 div가 보이면서 라디오 버튼을 선택하지 않으면
		if($('#choiceDiv').val()!=undefined){
			if(RadioTxtChkVal==undefined){
				alert('갯수를 선택 후 설문을 작성해주세요.');
				return false;
			}//if
		}//if
	}//if
	
	//텍스트탭 insert
	//질문txt와 내용1txt 내용2txt 모두 값이 있으면 db에 저장
	/*if($('li[rel="tab1"]').attr('class')=='active' || btn5Click==true){
	//if( $(tabChk+'#secondSurveyTitle1').val()!='' && $(tabChk+'#surveyContents1').val()!='' && $(tabChk+'#surveyContents2').val()!='' ){
		console.log('tabChk::'+tabChk);
		
		//txt val chk
		var txtContsCnt1 = $(tabChk+'input[id*="surveyContents"]').size();
		for(var i=0; i<txtContsCnt1; i++){
			if($(tabChk+'#contsValChkSpan'+(i+1)+'').attr('id')!=undefined){
				console.log('텍스트탭 txt val chk');
				return false;
			}//if
		}//for
		
		//FormData 선언
		var fd = new FormData();

		if(btn2Click==true){//별점형일 경우 중질문 이미지 val chk
			if($(tabChk+'#secSvyTitleImg').attr('src')==''){
				return false;
			}
			var titleFile = $('#tab1 #secSvyTitleUpload').prop('files')[0];
			console.log('titleFile::'+titleFile);
			fd.append('titleFile', titleFile);
			
		}
		
		//모든 text 필드 값
		var data = $(tabChk+'input[type="text"]').serialize();
		console.log('tabChk::'+tabChk);
		//var data = $('input[type="text"]').not('input[name="secondSurveyTitle"]').serialize();
		 
		//설문조사 유형, 순위형 : 1
		if(btn1Click==true){
			fd.append('surveyType', 1);
		}else if(btn2Click==true){	//설문조사 유형, 별점형 : 2
			fd.append('surveyType', 2);
		}else if(btn3Click==true){	//설문조사 유형, 택일형 : 3
			fd.append('surveyType', 3);
		}else if(btn4Click==true){	//설문조사 유형, 선택형 : 4
			fd.append('surveyType', 4);
		}else if(btn5Click==true){	//설문조사 유형, 텍스트형 : 5
			fd.append('surveyType', 5);
		}//if
		
		//설문조사 id 값
		fd.append('surveyId', $('#surveyId').val());
		//모든 text 필드 값 append
		fd.append('data', data);
		
		console.log('surveyId::'+$('#surveyId').val());
		//console.log('surveyType::'+surveyType);
		console.log('data::'+data);
		console.log(fd);
	
		$.ajax({
			url : '/upload/insertSurveySecondTitle',
			data : fd,
			type : 'POST',
			//dataType: 'json',
			processData : false,
			contentType : false,
			success : function(){
				alert('설문지가 저장되었습니다.');
				//팝업 초기화 
				reloadFunc();
			}//end success
		});//end ajax
		
	}else if($('li[rel="tab2"]').attr('class')=='active'){*/
		
		console.log('이미지 저장');
		
		//이미지탭일 경우
		if(btn1Click==true || btn3Click==true || btn4Click==true){
			var contsDivCnt = $('div[id*="contsDiv"]').size();
			console.log('contsDivCnt:::'+contsDivCnt);
			if(contsDivCnt<2){
				alert('최소 2개 이상의 답변을 작성해주세요.');
				return false;
			}//if
		}//if
		
		/* var txtContsCnt2 = $('input[id*="surveyContents"]').size();
		for(var i=0; i<txtContsCnt2; i++){
			if($('#contsValChkSpan'+(i+1)+'').attr('id')!=undefined){
				return false;
			}//if
		}//for */
		
		if($('#titleValChkSpan').attr('id')!=undefined){	//질문 제목 val chk
			return false;
		}//if
		
		//출처 val chk
		var surveyOrigin = $('input[id*="surveyOrigin"]').size();
		for(var i=0; i<surveyOrigin; i++){	
			if($('#originValChkSpan'+(i+1)+'').attr('id')!=undefined){
				return false;
			}//if
		}//for
		
		//img val chk
		var imgContsCnt = $('.img').size();
		for(var i=0; i<imgContsCnt; i++){
			/* console.log('img????????????????'+$('#img'+(i+1)+'').attr('src')); */
			var slashIdx = $('#img'+(i+1)+'').attr('src').lastIndexOf('/');
			var numberImg = $('#img'+(i+1)+'').attr('src').substring(slashIdx+1);
/* 			console.log('numberImg??'+numberImg); */
			
			if(numberImg == 'answer_n'+(i+1)+'.png'){
				alert('이미지를 등록해주세요.');
				return false;
			}//if
		}//for
		
		//FormData 선언
		var fd = new FormData();
		//Crop된 이미지 Array
		var imageArray = new Array();
		if(btn2Click==true){//별점형일 경우 중질문 이미지 val chk
			
			if($('#secSvyTitleImg').attr('src')==''){
				return false;
			}
		
			var image = $('#secSvyTitleImg').attr('src').replace(/^data:image\/(png|jpeg);base64,/, "");
			
	        fd.append('crop_image', image);
			var titleFile = $('#secSvyTitleUpload').prop('files')[0];
			console.log('titleFile::'+titleFile);
			fd.append('titleFile', titleFile);
			
		}
		
		//모든 text 필드 값
		var data = $('input[type="text"]').serialize();
		//중질문 답변 이미지 파일 개수
		var fileCnt = $('input[name="surveyImagePath"]').size();
		console.log('fileCnt:::'+fileCnt);
		
		//중질문 답변 이미지 파일 값
		/* for(var i=0; i<fileCnt; i++){
			i = parseInt(i); */
			//console.log('중질문이미지크롭:::'+$('#img'+(i+1)).attr('src'));
			
			//var file = $('input[name=surveyImagePath]').attr('id')
			
			
		$('input[name=surveyImagePath]').each(function(index, domEle) {
			 var variable = '#'+$(domEle).attr('id');
			 
			 if(typeof $(variable).prop("files")[0] != 'undefined'){
				 
				if( $(domEle).attr('id').split('surveyImagePath_')[1] != undefined ){
				 	var variable_id = $(domEle).attr('id').split('surveyImagePath_')[1]
					//console.log('variable_id :::'+variable_id );
				 	variable_id = parseInt(variable_id);
				 	//console.log($(variable).parents('.answer_n').css('background-image').replace(/"/g, "").replace(/^url|[\(\)]/g, "").replace(/^data:image\/(png|jpeg);base64,/, ""));
				 	fd.append('crop_image'+variable_id, $(variable).parents('.answer_n').css('background-image').replace(/"/g, "").replace(/^url|[\(\)]/g, "").replace(/^data:image\/(png|jpeg);base64,/, ""));
				 	
					fd.append('file', $(variable).prop("files")[0]) 	 
				}else {
					var variable_id = $(domEle).attr('id').split('surveyImagePath')[1]
					//console.log('variable_id :::'+variable_id );
				 	variable_id = parseInt(variable_id);
				 	//console.log($('#img'+variable_id+'').attr('src').replace(/^data:image\/(png|jpeg);base64,/, ""));
				 	fd.append('crop_image'+variable_id, $('#img'+variable_id+'').attr('src').replace(/^data:image\/(png|jpeg);base64,/, ""));
				 	
					fd.append('file', $(variable).prop("files")[0])
				}
				
			 }
		 }); 
			
			/* return false; */
	
			/* $('input[name=surveyImagePath]').each(function(index, domEle) {
			 
				console.log(index);
				var image = $('#img'+(index+1)+'').attr('src').replace(/^data:image\/(png|jpeg);base64,/, "");
				
		        fd.append('crop_image'+(index+1), image);
			 }); */
			//
			  
			//console.log('file:::::::');
			//console.log(file);
			
		/* } *///for
		$('.progress_wrap').css('display','');
		console.log(imageArray);
		//설문조사 유형, 순위형 : 1
		if(btn1Click==true){
			fd.append('surveyType', 1);
		}else if(btn2Click==true){	//설문조사 유형, 별점형 : 2
			fd.append('surveyType', 2);
		}else if(btn3Click==true){	//설문조사 유형, 택일형 : 3
			fd.append('surveyType', 3);
		}else if(btn4Click==true){	//설문조사 유형, 선택형 : 4
			fd.append('surveyType', 4);
		}else if(btn5Click==true){	//설문조사 유형, 텍스트형 : 5
			fd.append('surveyType', 5);
		}//if
		
		//설문조사 id 값
		fd.append('surveyId', getUrlParameter('surveyId'));
		//모든 text 필드 값 append
		fd.append('data', data);
		
		//partnerId 값
		var partnerId = getUrlParameter('partnerId');
		console.log('partnerId::'+partnerId);
		fd.append('partnerId', partnerId);
		$('.second.circle').circleProgress({
			  value: 1
			}).on('circle-animation-progress', function(event, progress) {
			  $(this).find('strong').html(parseInt(100 * progress) + '<i>%</i>');
			  if(progress == 1){
				  $.ajax({
						url : '/upload/insertSurveySecondTitle',
						data : fd,
						type : 'POST',
						//dataType: 'json',
						processData : false,
						contentType : false,
						success : function(){
						
							setInterval(function(){ location.reload(); }, 200);
							/* alert('설문지가 저장되었습니다.'); */
							//팝업 초기화 
							//reloadFunc();
							/* location.reload(); */
						}//end success
					});//end ajax
			  }
			});

	//}//if
}

//임시저장
function tempStore(i, j){
	//FormData 선언
	var fd = new FormData();
	
	if($('#surveyType'+(i+1)+'').val()=='2'){//별점형일 경우 중질문 이미지 val chk
		if($('#secSvyTitleImg'+(i+1)+'').attr('src')==''){
			return false;
		}
		var titleFile = $('#secSvyTitleUpload'+(i+1)+'').prop('files')[0];
		console.log('titleFile::'+titleFile);
		fd.append('titleFile', titleFile);
	}//if
	
	//컨텐츠 array 선언 
	var conts = new Array();
	
	var value = imgArr.getValue();
	if($('#surveyAnswerType'+(i+1)+'').val()=='2'){	//이미지일 경우에만 이쪽을 돔
		for(var no in value){
			no = parseInt(no);
			var contsNo = value[no].split('_')[1];
			console.log('value[no]::'+value[no]);
			console.log('contsNo::'+contsNo);
			//file length 선언
			var fileLeng = $('#surveyDiv'+i+' input[type="file"]').size();
			console.log('fileLeng::'+fileLeng);
			
			//contsId 값
			var contsId = $('#'+value[no]).children('input[name="surveyContentsId"]').val();
			console.log('해당 no에 대한 contsId:'+contsId);
			//img path id 값
			var imgPathId = $('#'+value[no]).children('input[name="surveyImagePath"]').attr('id');
			console.log('해당 no에 대한 imgPathId:'+imgPathId);
			//var file = ($('#'+value[no]).children('input[name="surveyImagePath"]'))[no].files[0];
			var file = $('#surveyDiv'+i+' input[name="surveyImagePath"]')[(contsNo-1)].files[0];
			fd.append('file', file);
			//var file = $('#surveyDiv'+i+' input[type="file"]')[(fileLeng-1)].files[0];
			//console.log(file);
			
			//이미지일 경우 텍스트는 안받음(이미지만 받는다)
			
			//컨텐츠 내용 div id 값 선언 (이미지일시 텍스트 값 안받음 혹시 모르니 추후 삭제) 
			//var txtContsDiv = $('#'+value[no]).children('#txtContsDiv'+(contsNo)+'').attr('id');
			//컨텐츠 내용 값 
			//var txtContsVal = $('#'+txtContsDiv+'').children('input[name="surveyContents"]').val();
			//console.log('해당 no에 대한 txtContsVal:'+txtContsVal);
			
			//컨텐츠들을 담음
			conts.push({'contsId':contsId, 'imgPathId':imgPathId});
			//conts.push({'contsId':contsId, 'imgPathId':imgPathId, 'txtContsVal':txtContsVal});
			console.log(file);
		}//for
	}//if
		
	//컨텐츠를 json string으로 담음
	var contsJson = JSON.stringify(conts);
	
	//답변 타입 선언
	var surveyAnswerTypeVal = $('#surveyDiv'+i+' input[name="surveyAnswerType"]').val();
	
	if(surveyAnswerTypeVal=='1'){//텍스트 타입
		txtValChk();
	}else if(surveyAnswerTypeVal=='2'){//이미지 타입
		imgValChk();
	}//if
	
	//해당 질문의 컨텐츠 개수 선언
	var ContsCnt = $('#surveyDiv'+i+' .contsDiv'+i+'').size();
	
	//컨텐츠 img와 txt val chk 
	for(var no=0; no<ContsCnt; no++){
		if($('#surveyDiv'+i+' #contsValChkSpan'+(no+1)+'').attr('id')!=undefined){
			return false;
		}//if

		if($('#surveyDiv'+i+' #imgChkSpan'+(i+1)+'_'+(no+1)+'').attr('id')!=undefined){
			return false;
		}//if
	}//for
	
	//질문txt와 내용1txt 내용2txt 모두 값이 있으면 db에 저장
	if($('input[name="secondSurveyTitle"]').val()!='' && $('#surveyContents'+(i+1)+'_'+(j+1)+'').val()!=''){
		
		//$('#surveyTypeIdSpan'+i+' ');
		//설문조사 유형 id 선언
		var surveyTypeId = $('#surveyTypeId'+(i+1)).val();
		
		//질문 값
		var secondSurveyTitle = $('#surveyDiv'+i+' input[name="secondSurveyTitle"]').val();
		
		//컨텐츠 id 값
		var surveyContentsId = $('#surveyDiv'+i+' input[name="surveyContentsId"]').serialize();
		
		//컨텐츠 txt 값
		var surveyContents = $('#surveyDiv'+i+' input[name="surveyContents"]').serialize();
		
		//질문 append
		fd.append('secondSurveyTitle', secondSurveyTitle);
		//컨텐츠 부분(이미지, id, 컨텐츠txt) append
		fd.append('contsJson', contsJson);
		//컨텐츠 id
		fd.append('surveyContentsId', surveyContentsId);
		//컨텐츠 txt
		fd.append('surveyContents', surveyContents);
		
		$.ajax({
			url : '/upload/tempStoreSvySecTitle?surveyTypeId='+surveyTypeId,
			data : fd,
			//dataType : json,
			type : 'POST',
			processData : false,
			contentType : false,
			success : function(){
				console.log('임시저장 성공!');
				alert('임시 저장되었습니다.');
				
				//팝업 초기화 
				//reloadFunc();
				location.reload();
			}
		});//end ajax
	}//if
}
</script>
</head>
<body>

<div class="register_survey" id="dialog-listSurvey" style="margin-top:30px; display:none;" >
<span id="IDO-dialog-title"><h1></h1></span>
	<!-- <form>
   		<fieldset> -->
   			<div class="left" style="position:absolute; left:3%;">
   				<img src="/images/builder/survey/mobile/arrow_back.png" style="width: 15px; height: 26px;">
   			</div>
   			<div class="bubble"></div>
   			<div class="eng_top_banner"></div>
   			<div class="kor_top_banner"></div>
   			<div class="survey_title">
   				<!-- <input type="text" id="secondSurveyTitle2" name="secondSurveyTitle" placeholder="질문 제목을 입력해주세요" style="width: 95%; margin: 32px 0 0 2%; height:50px; border: 1px solid #cbd5df; border-radius: 5px; "> -->
   			</div>
	   		<div id="makeq" class="padding-fix">  
				<section class="choiceType">
					<div class="choice_type_txt"></div> 
					<ul> 
						<li><a href="#" class="crownOff typeBtn" id="btn1" onclick="button1()"></a></li> 
						<li><a href="#" class="starOff typeBtn" id="btn2" onclick="button2()"></a></li>
						<li><a href="#" class="choiceOff typeBtn" id="btn3" onclick="button3()"></a></li> 
						<li><a href="#" class="numberOff typeBtn" id="btn4" onclick="button4()"></a></li> 
						<!-- <li><a href="#" class="textOff" id="btn5" onclick="button5()"></a></li> -->    
					</ul>
				</section><!-- //choiceType -->   
	    		<!-- <input type="text" id="surveyId"> -->
		  		<div class="surveyDiv"><!-- 전체 div -->
	  				<!-- 설문조사 insert div -->
	  				<div class="list_btn" id="listBtn"><img class="list_btn_img" src="/images/common/builder/m_survey/list_go_bt.png"></div><!-- 리스트 이동 버튼 -->
	  				<div class="list_wrap" id="listWrap" style="display:none; width:100%; height: 100%; background-color: #fff; position: fixed; z-index:10; top:0; left:0; overflow: scroll;">
	  					<div class="wrap_header">
							<div class="close_btn"><img src="/images/common/builder/m_survey/survey_list_closebt.png"></div>
							<div class="list_eng_banner">IDO MAKE RESEARCH</div>
							<div class="list_kor_banner">설문리스트</div>
						</div>
		  				<div id="listDiv"></div><!-- 설문조사 list div -->
	  				</div><!-- 리스트 화면 -->
	  				<div class="footer">
	  					<div class="preview_btn"></div>
	  					<div class="finish_btn"></div>
	  				</div>
		  		</div>
	  		</div>
    	<!-- </fieldset>
  	</form> -->
</div> 
<!-- 흥열작업 -->


<!-- 샘플 템플릿 wrap -->
<div class="sample_wrap" style="">
	<div class="wrap_header">
		<!-- <div class="closeButton"><img src="/images/main/survey/sub_close_bt.png"></div> -->
		<div class="category_btn"></div>
		<div class="surveyTitle">
			<div style="padding-left:0; width:100%;"><img src="/img/mobile/builder/survey/reg_survey/make_title01.png" width="80%"></div>
			<div style="width:95%; font-size:10pt; height:50px; padding-left:5%; padding-top: 28px;" class="surveyTitle_input" id="surveyTitle_input">
				<input type="text" id="secondSurveyTitle" name="secondSurveyTitle" style="width:90%; height:40px;" readonly value="질문유형을 선택해주세요">
			</div>
			<div style="display:none; border" class="select_title_type title_wrap">
				<div class="select_title_type_1">당신의 선택은?</div>
				<div class="select_title_type_2">마음에 드는 상품/서비스/상호를 골라주세요</div>
				<div class="select_title_type_3" style="height: 50%;">자유형
					<!-- <input type="text" class="free_title" style="width:90%;"> -->				
				</div>
			</div>
		</div>
	</div>
	<div class="hidden_div"></div>
	<div class="select_answer_number_container">
		<div style="margin:0 auto; width:100%;"><img src="/img/mobile/builder/survey/reg_survey/make_title02.png" width="80%"></div>
		<div style="height: 10px;"></div>
		<select id="number" style="width: 80%; height:30px;  margin-left:10%;  text-align-last:center;">
			<!-- <option value="" style="text-align: center">응답 개수</option> -->
			<option value="2">2</option>
			<option value="3">3</option>
			<option value="4">4</option>
			<option value="5">5</option>
			<option value="6">6</option>
			<option value="7">7</option>
			<option value="8">8</option>
		</select>
	</div>
	<div class="sample_answer_view_container"> <!-- 몇가지가 선택됐는지 확인해주는 부분 -->
	</div>
	<div class="sample_footer" style="display:none;">
		<div class="modify_btn">수정</div> 
		<div class="finish_btn">완료</div>
	</div>
</div>
<!-- //샘플 템플릿 wrap -->

<!-- 정보 입력 wrap -->
<div class="insert_info_wrap" style="display:none; width: 100%; height: 100%; position: fixed; left: 0; top: 0; background-color: #000000; z-index:200;"></div>
<!-- //정보 입력 wrap -->

<!-- 응답유형선택 wrap -->
<div class="answer_type_wrap" style="display:none; width: 100%; height: 100%; position: fixed; left: 0; top: 0; background-color: #000000; z-index:200;">
 	<div class="answer_type_wrap_header">
 	</div>
 	<div class="answer_type_wrap_contents">
 		<div>응답유형 선택하세요</div>
 		<br>
	 	<ul> 
			<li><a href="#" class="eitherOff typeBtn" id="btn1" onclick="button1()"></a></li> 
			<li><a href="#" class="singleOff typeBtn" id="btn2" onclick="button2()"></a></li>
			<li><a href="#" class="choiceOff typeBtn" id="btn3" onclick="button3()"></a></li> 
			<li><a href="#" class="crownOff typeBtn" id="btn4" onclick="button4()"></a></li> 
			<li><a href="#" class="starOff typeBtn" id="btn5" onclick="button5()"></a></li> 
		</ul>
 	</div>
 	<div class="answer_type_wrap_footer">
 		<div class="modify_btn">수정</div>
 		<div class="finish_btn">완료</div>
 	</div>
</div>
<!-- //응답유형선택 wrap -->

<!-- //흥열작업 -->
<style type="text/css">
select{
    text-align:right;   
}
option{
    text-align:right;   
}
.regImage_view_container{
	width: 100%;
	height: 67%;
	overflow: scroll;
}

</style>

<script type="text/javascript">
$(document).ready(function(){
	
	//카테고리 뿌리기
	$.ajax({
		url : '/upload/select_content?contentsId='+getUrlParameter('contentsId')+'',
		type : 'GET',
		success : function(data){
			console.log(data[0].CATEGORY);
			console.log(data[0].CATEGORY.split('_')[0]);
			console.log(data[0].CATEGORY.split('_')[1]);
			var category = data[0].CATEGORY.split('_')[0];
			var sub_category = data[0].CATEGORY.split('_')[1];
			//$('.category_btn').append('<img class="cate_bullet" src="/img/mobile/builder/survey/reg_survey/make_cate_bullet.png">');
			$('.category_btn').html('<img class="cate_bullet" src="/img/mobile/builder/survey/reg_survey/make_cate_bullet.png"> '+category+' > '+sub_category);
		}//end success
	});//end ajax	
	
	$('.success_survey_wrap').css('display','none'); //설문 작성 완료후 신청/추가 선택화면
	
	$('.select_answer_number_container').css('display','none'); //응답수 selectbox

	$('#surveyTitle_input').click(function(){
		$('.select_title_type').css('display','');
		$('.hidden_div').css('height','20%')
	})
	
	$('.select_title_type div').click(function(){
		console.log('들어옴"0')
		$('.sample_wrap .sample_footer').css('display',''); //완료 버튼 보이기
		
		$(this).blur(); 
		console.log('select_title_type::'+$(this).attr('class') );
		console.log('select_title_type::'+$(this).text());
		if( $(this).attr('class') == 'select_title_type_3' ){ //자유형이면
			$('.surveyTitle_input input[type="text"]').attr('placeholder','질문 제목을 입력해주세요.');
			$('.surveyTitle_input input[type="text"]').attr("readonly",false);
			$('.surveyTitle_input input[type="text"]').val($('.select_title_type_3 input[type=text]').val());
			$('.surveyTitle_input input[type="text"]').removeAttr('disabled');
			$('.surveyTitle_input input[type="text"]').css('text-align','left');
			$('.surveyTitle_input input[type="text"]').focus();
		}else {
			$('.surveyTitle_input input[type="text"]').val($(this).text());
			console.log('타이틀값:::::'+$('.surveyTitle_input input[type="text"]').val());
			$('.surveyTitle_input input[type="text"]').attr('disabled','disabled');
			$(this).blur(); 
		}
		
		if( $('.surveyTitle_input input[type="text"]').val()!='undefined' ){//select box 가리기
			$("#number option:eq(0)").attr("selected", "selected");
			$('.select_title_type').css('display','none'); //질문 유형 selecbox 가리기
			$('.hidden_div').css('height','')	//질문 유형 아래 div height 
			$('.select_answer_number_container').css('display','');	//응답수 selectbox 보이기
			
			var number = $("#number option:selected").val();
			$('#answer_number').val(number);
			$('.sample_answer_view_container').empty();
			/* $('.wrap_footer').css('display',''); */ //
			for(var i=0; i<number; i++){
				$('.sample_answer_view_container').append('<div class="answer_n" id="a_'+(i+1)+'" style="">'+
														   		'<img class="" id="img'+(i+1)+'" onclick="document.all.surveyImagePath'+(i+1)+'.click()" src="/img/mobile/builder/survey/reg_survey/answer_n'+(i+1)+'.png">'+
														   		'<input type="file" accept="image/*" enctype="multipart/form-data" name="surveyImagePath"id="surveyImagePath'+(i+1)+'" style="display: none;"/>'+
														   '</div>');
			}
			switch(number){
				case '2' : 
					$('.answer_n').css('float', 'left')
					$('.answer_n').css('margin-left', '10%')
					$('.answer_n').css('margin-top', '10%')
				break;
			}
			
			$('.sample_wrap .sample_footer').css('display',''); //완료 버튼 보이기
		}
		
	});
	
	/* $("#makeq").on("click", ".make_answer", function() {
		$('#secondSurveyTitle_hidden').val($('#secondSurveyTitle2').val());
		$('.sample_wrap').css('display','');
		$('.surveyTitle').append($('#secondSurveyTitle_hidden').val());
		$('body').css('position','fixed');
    }); */

	$(".select_answer_number_container select").change(function(){
		
		var number = $("#number option:selected").val();
		$('#answer_number').val(number);
		$('.sample_answer_view_container').empty();
		/* $('.wrap_footer').css('display',''); */ //
		$('.sample_wrap .sample_footer').css('display','');
		for(var i=0; i<number; i++){
			$('.sample_answer_view_container').append('<div class="answer_n" id="a_'+(i+1)+'" style="">'+
													   		'<img class="" id="img'+(i+1)+'" onclick="document.all.surveyImagePath'+(i+1)+'.click()" src="/img/mobile/builder/survey/reg_survey/answer_n'+(i+1)+'.png">'+
													   		'<input type="file"  accept="image/*" name="surveyImagePath"id="surveyImagePath'+(i+1)+'" style="display: none;"/>'+
													   		'<div class="info_input_btn" id="infoInputBtn_'+(i+1)+'" style="display:none;"><img src="/img/mobile/builder/survey/reg_survey/make_addbt1.png"></div>'+
													   		'<div class="modify_input_btn" id="modifyInputBtn_'+(i+1)+'" style="display:none;"><img src="/img/mobile/builder/survey/reg_survey/make_addbt2.png"></div>'+
													   '</div>');
		}
		
		//공통
		$('.answer_n').css('float', 'left')
		$('.answer_n').css('margin-left', '10%');
		$('.answer_n').css('margin-top', '5%');
		
		switch(number){
			case '2' : 
				/* $('.answer_n').css('float', 'left')
				$('.answer_n').css('margin-left', '10%') */
				$('.answer_n').css('margin-top', '10%')
			break;
			case '3' : 
				/* $('.answer_n').css('float', 'left')
				$('.answer_n').css('margin-left', '10%')
				$('.answer_n').css('margin-top', '5%') */
				$('#a_3').css('margin-left', '32.5%')
			break;
			case '4' : 
				/* $('.answer_n').css('float', 'left')
				$('.answer_n').css('margin-left', '10%')
				$('.answer_n').css('margin-top', '5%') */
			break;
			case '5' : 
				/* $('.answer_n').css('float', 'left')
				$('.answer_n').css('margin-left', '10%')
				$('.answer_n').css('margin-top', '5%') */
			break;
			case '6' : 
				/* $('.answer_n').css('float', 'left')
				$('.answer_n').css('margin-left', '10%')
				$('.answer_n').css('margin-top', '5%') */
			break;
			case '7' : 
				/* $('.answer_n').css('float', 'left')
				$('.answer_n').css('margin-left', '10%')
				$('.answer_n').css('margin-top', '5%') */
			break;
			case '8' : 
				/* $('.answer_n').css('float', 'left')
				$('.answer_n').css('margin-left', '10%')
				$('.answer_n').css('margin-top', '5%') */
			break;
		}
	});
	
	
	$('.sample_wrap .closeButton').on('click', function(){
		$('.sample_wrap').css('display','none');
		$('body').css('position','');
	});
	
	
	//정보입력 버튼 클릭
	$('.sample_answer_view_container').on('click', '.info_input_btn', function(){
		console.log('클릭????');
		$('.insert_info_wrap').css('display','');
		console.log('img id::::::::::::::::'+$('.info_input_btn').parent().children('img').attr('id'));
		console.log('this id 값::'+$(this).attr('id'));
		var clickId = $(this).attr('id').split('_')[1];
		console.log('clickId::'+clickId);
		
		var info_html = '';
		info_html += '<div class="insert_info_div" id="insert_info_div'+clickId+'">'+
						'<div class="info_banner">상품/서비스 상세정보 입력</div>'+
						'<div class="info_img_div" id="infoImgDiv'+clickId+'">'+	
							'<img class="info_img" id="infoImg'+clickId+'">'+	
						'</div>'+	
						'<div class="info_input_div">'+	
							'<input type="text" id="surveyOrigin'+clickId+'" name="surveyOrigin" placeholder="이미지 출처를 입력해주세요(필수)">'+	
							'<input type="text" id="surveyContents'+clickId+'" name="surveyContents" placeholder="이미지 이름을 입력해주세요">'+	
							'<input type="text" id="surveyLinkAddr'+clickId+'" name="surveyLinkAddr" placeholder="링크 주소를 입력해주세요">'+	
						'</div>'+	
						'<div class="info_footer" id="infoFooter'+clickId+'">확인</div>'+	
					 '</div>';
		
		//if( $('#insert_info_div'+clickId+'').attr('id') == 'undefined') {
			$('.insert_info_wrap').append(info_html);
		//}
	
		var info_img =  $('#infoInputBtn_'+clickId).parent().children('img').attr('src');
		$('.insert_info_wrap #infoImg'+clickId).attr('src', info_img); //이미지 append 시키는 부분
		
		$('.insert_info_wrap').on('click', '#infoFooter'+clickId+'', function(){
			console.log('확인클릭');
			
			//사진/이미지 출처 정보 val chk
			if( typeof $('#surveyOrigin'+(clickId)).val()=='undefined' ||  $('#surveyOrigin'+(clickId)).val()==''){
				alert('이미지 출처를 입력해주세요.');
				return false;
			}//end if		
			
			$('#infoInputBtn_'+clickId).css('display','none')
			$('#infoImgDiv'+clickId).css('display','none')
			
			$('#modifyInputBtn_'+clickId).css('display','');
			$('.insert_info_wrap').css('display','none');
			$('#insert_info_div'+clickId).css('display','none');
			//$('#infoInputBtn_'+clickId+'').text('정보수정');
		});
	});
	
	$('.sample_answer_view_container').on('click', '.modify_input_btn', function(){
		var modifyId = $(this).attr('id').split('_')[1];
		console.log(modifyId)
		$('#infoImgDiv'+modifyId).css('display','')
		$('.insert_info_wrap').css('display','');
		$('#insert_info_div'+modifyId).css('display','');
	});
	
	//수정버튼 클릭
	$('.sample_wrap').on('click', '.modify_btn', function(){
		if (confirm("정말 수정을 하시겠습니까?") == true){		
			location.reload();
		}else {
			return;
		}//if
	});
	
	//완료버튼 클릭
	$('.sample_wrap').on('click', '.finish_btn', function(){
		
		var index = $("#number option:selected").text(); //답변이 몇개가 선택됐는지 확인하는 index 값 
		if(index == 2){
			$('.singleOff').parents('li').css('display','none');
		}else{
			$('.eitherOff').parents('li').css('display','none');
		}
		
		if( $('#secondSurveyTitle').val()=='' ){
			alert('질문 제목은 필수 항목입니다.');
			return false;
		}
		
		var imgChk = true;
		var valChk = true;
		
		$('.sample_answer_view_container .answer_n ').each(function(index){
			console.log('index::'+index);
			
			var slashIdx = $('#img'+(index+1)+'').attr('src').lastIndexOf('/');
			var numberImg = $('#img'+(index+1)+'').attr('src').substring(slashIdx+1);
			//이미지 val chk
			if(numberImg == 'answer_n'+(index+1)+'.png'){
				imgChk=false;
				alert('사진/이미지를 등록해주세요.');
				return false;
			}else {
				imgChk=true;
			}//if
			
			//정보입력 val chk
			if( typeof ($('#surveyOrigin'+(index+1)).val()) =='undefined' ||  $('#surveyOrigin'+(index+1)).val()==''){ //사진/이미지 출처 정보 val chk
				valChk=false;				
				alert('사진/이미지의 정보를 입력해주세요.');
				return false;
			}else {
				valChk=true;
			}//if
		});
		
		if( imgChk==true && valChk==true ){//이미지랑 정보입력 val chk
			$('.sample_wrap').css('display','none'); //이미지 등록 view 숨김
			$('.answer_type_wrap').css('display','');	//응답유형 선택 view 보이기
		}//if
		
	});
	
	//응답유형 수정 버튼 클릭
	$('.answer_type_wrap .modify_btn').on('click', function(){
		console.log('응답유형 수정');
		
		//응답 유형 초기화
		$('.answer_type_wrap_contents #btn1').attr('class','eitherOff');
		$('.answer_type_wrap_contents #btn2').attr('class','singleOff');
		$('.answer_type_wrap_contents #btn3').attr('class','choiceOff');
		$('.answer_type_wrap_contents #btn4').attr('class','crownOff');
		$('.answer_type_wrap_contents #btn5').attr('class','starOff');

		btn1Cnt = 0;	//순위형 클릭수 
		btn2Cnt = 0;	//벌점형 클릭수 
		btn3Cnt = 0;	//택일형 클릭수 
		btn4Cnt = 0;	//선택형 클릭수 
		btn5Cnt = 0;	//텍스트형 클릭수 
		
		btn1Click = false;	//순위형 클릭
		btn2Click = false;	//별점형 클릭
		btn3Click = false;	//택일형 클릭
		btn4Click = false;	//선택형 클릭
		btn5Click = false;	//텍스트형 클릭
		
		//console.log('btn1Cnt::'+btn1Cnt+', btn2Cnt::'+btn2Cnt+', btn3Cnt::'+btn3Cnt+', btn4Cnt::'+btn4Cnt+', btn5Cnt::'+btn5Cnt);
		//console.log('btn1Click::'+btn1Click+', btn2Click::'+btn2Click+', btn3Click::'+btn3Click+', btn4Click::'+btn4Click+', btn5Click::'+btn5Click);
		
	});

	//응답유형 완료 버튼 클릭
	$('.answer_type_wrap .finish_btn').on('click', function(){
		if($('#answer_type_click_count').val() == 0){
			alert('응답유형은 필수 항목입니다');
		}else{
			if($('#answer_type').val() == 'star' || $('#answer_type').val() == 'select'){
			
				$('.additional_wrap').css('display','');
				$('.additional_footer').css('display','none');	//footer 안보이게
				
				if($('#answer_type').val() == 'star'){ //별점형
					console.log('별점형 에디터');
					$('.additional_header').append(	'<div class="sample_view"><img class="sample_view_img" src="/img/mobile/builder/survey/reg_survey/sample_bt.png"></div>'+
													'<div class="survey_title" style="color:#fff;">'+$('#secondSurveyTitle').val()+'</div>');
					
					if( $('#secondSurveyTitle').val().length > 15 ){ //질문 제목이 길면 사이즈 줄임
						$('.survey_title').css('font-size', '1.2em');
					}
					
					//별점형 이미지/평가항목 div
					$('.additional_container').append('<div class="star_img_div"></div>'+
													  '<div class="star_item_div">'+
													  	'<div class="star_item_title"><img src="/img/mobile/builder/survey/reg_survey/star_ico.png">최대 <font color="#f9ae0c">5개</font>까지 입력하실 수 있습니다.</div>'+
													  	'<div class="star_input_div"></div>'+
													  '</div>');
					
					/** 별점형 이미지 부분 **/
					$('.sample_answer_view_container .answer_n ').each(function(index){
						console.log('index::'+index);
						var star_img_html = '';
						star_img_html +=  '<div class="answer_n" id="a_'+(index+1)+'">'+
			   									'<img class="" id="img'+(index+1)+'" src="/img/mobile/builder/survey/reg_survey/answer_n'+(index+1)+'.png">'+
			   								'</div>';
						$('.star_img_div').append(star_img_html);	
						
						//응답 이미지 가져오기
						$('.additional_container #img'+(index+1)).attr('src', $('.sample_answer_view_container #img'+(index+1)).attr('src'));
						
					});
					
					//별점형에서 응답이미지 크기 작게 처리
					//$('.additional_container .answer_n').css({'width':'120px', 'height':'120px'});
					
					console.log('응답이미지수::'+$('.sample_answer_view_container .answer_n').size());
					var answer_size =  $('.sample_answer_view_container .answer_n').size();
					switch(answer_size){
						case 2 : 
							console.log('응답이미지수 2개!!!');
							$('.answer_n').css('float', 'left')
							$('.answer_n').css('margin-top', '5%')
							$('.answer_n').css('margin-left', '10%')
							$('.survey_title').css('padding-top', '15%')
							$('.star_img_div').css('height', '45%');
							$('.star_item_div').css('height', '55%');
							//$('.star_input_div').css('padding-bottom','0');
						break;
						case 3 :
							console.log('응답이미지수 3개!!!');
							$('.answer_n').css('float', 'left');
							$('.answer_n').css('margin-top', '2%');
							$('.answer_n').css('margin-left', '10%');
							$('.answer_n').css('margin-bottom', '5%');
							$('.additional_container #a_3').css('margin-left', '32.5%');
						break;
						case 4: case 5: case 6: case 7: case 8:
							$('.answer_n').css('float', 'left');
							$('.answer_n').css('margin-top', '2%');
							$('.answer_n').css('margin-left', '10%');
							$('.answer_n').css('margin-bottom', '5%');
						break;
						/* case 5 : 
							
							$('.answer_n').css('float', 'left');
							$('.answer_n').css('margin-top', '2%');
							$('.answer_n').css('margin-left', '12%');
							$('.answer_n').css('margin-bottom', '5%');
						break;
						case 6 : 
							$('.answer_n').css('float', 'left');
							$('.answer_n').css('margin-top', '2%');
							$('.answer_n').css('margin-left', '12%');
							$('.answer_n').css('margin-bottom', '5%');
						break;
						case 7 : 
							$('.answer_n').css('float', 'left');
							$('.answer_n').css('margin-top', '2%');
							$('.answer_n').css('margin-left', '12%');
							$('.answer_n').css('margin-bottom', '5%');
						break;
						case 8 : 
							$('.answer_n').css('float', 'left');
							$('.answer_n').css('margin-top', '2%');
							$('.answer_n').css('margin-left', '12%');
							$('.answer_n').css('margin-bottom', '5%');
						break; */
					}//switch
					/** 별점형 이미지 부분 **/
					
					/** 별점형 평가 항목 부분 **/
					var star_item_html = '';
					star_item_html += '<span class="star_item" id="starItem1"><input type="text" id="evaluationItem1" name="evaluationItem" placeholder="평가 항목을 입력해주세요(필수)"><img src="/img/mobile/builder/survey/reg_survey/plus_bt.png" class="add_btn" id="addBtn1" onclick="addBtn(1)"><img src="/img/mobile/builder/survey/reg_survey/minus_bt.png" class="remove_btn" id="removeBtn1" onclick="removeBtn(1)"></span>';
					
					$('.star_input_div').append(star_item_html);
					/** 별점형 평가 항목 부분 **/
					
					$('input[name="evaluationItem"]').focus(function(e){
						console.log('평가항목 포커스');
						$('.additional_footer').css('display','');	//footer
					});
					
					$('input[name="evaluationItem"]').focusout(function(e){
						var evaluationItem = $('input[name="evaluationItem"]').val();
						if( evaluationItem  == '') {
						console.log('평가항목 키다운');
						$('.additional_footer').css('display','none');	//footer 안보이게
						}
					}); 
					
					//수정버튼 클릭
					$('.additional_footer .modify_btn').click(function(){
						$('.star_input_div').empty();//input div 지우고 
						$('.star_input_div').append(star_item_html); //다시 생성
					});
					
					//완료버튼 클릭
					var evalChk=true;
					$('.additional_footer .finish_btn').click(function(){
						$('input[name="evaluationItem"]').each(function(idx){
							
							var evaluationItem = $('#evaluationItem'+(idx+1)+'').val();
							
							if( evaluationItem == '' || typeof evaluationItem == 'undefined'){
								evalChk = false;	
								alert('평가 항목을 입력해주세요');
								return false;
								//alert('평가 항목을 입력해주세요');	
								//return false;
							}else {
								evalChk = true;
							}//if
							
						});
						if(evalChk == true){
							insertFunc();
						}
					});
					
				}else{ //복수선택형
					//pp
					$('.additional_wrap').css('display','');
					$('.additional_header').css('height','30%');
					$('.additional_container').css('height','62%');
					$('.additional_footer').css('display','none');	//footer 안보이게
					
					$('.additional_header').append('<div class="select_title">복수선택형 평가항목 개수선택</div>');
					
					//셀렉트 박스 화살표 
					var arrow_icon = '<span class="arrow_icon"><img src="/img/mobile/builder/survey/reg_survey/arrow_y_bt.png"></span>';
					
					$('.additional_container').append(	'<div class="select_type_answer_title" >응답 개수를 선택해주세요'+
															arrow_icon +
													 	'</div>'+
													 	'<div class="anwer_num_div"></div>');
					
					var number = $("#number option:selected").val();
					for(var i=1; i<number; i++){
						$('.anwer_num_div').append('<div class="select_type_answer_number" id="n_'+(i+1)+'">'+(i+1)+'</div>');
					}//for
					
					$('.select_type_answer_number').css('display','none');
					
					$('.additional_wrap').on('click','.select_type_answer_title', function(){
					
						$('.select_type_answer_number').css('display','');
						
						$('.additional_wrap').on('click','.select_type_answer_number', function(){
							$('.select_type_answer_title').empty();
							$('.select_type_answer_title').append($(this).attr('id').split('n_')[1]+arrow_icon);
							$('.select_type_answer_number').css('display','none');
							$('.additional_footer').css('display','');	//footer 보이게
						});
						
					})
					
					//수정버튼 클릭
					$('.additional_footer .modify_btn').click(function(){
						$('.select_type_answer_title').empty(); //응답개수 선택 지우기
						$('.select_type_answer_title').html('응답 개수를 선택해주세요'+arrow_icon); //다시 생성
					});
					
					//완료버튼 클릭
					$('.additional_footer .finish_btn').click(function(){
						insertFunc();
					});
				} 
				
			} else {	// 양자택일형/단수선택형/순위형
				insertFunc();
			}
			//return false;
			
		}//end if
		
	});
			
	function insertFunc(){
		//FormData 선언
		var fd = new FormData();
		
		var secondSurveyTitle = $('#secondSurveyTitle').val();
		fd.append('secondSurveyTitle',secondSurveyTitle);
	
		//모든 text 필드 값
		var data = $('input[type="text"]').serialize();
		console.log(data);
		
		//중질문 답변 이미지 파일 개수
		var fileCnt = $('input[name="surveyImagePath"]').size();
		console.log('fileCnt:::'+fileCnt);
		
		//중질문 답변 이미지 파일 값
		$('input[name=surveyImagePath]').each(function(index, domEle) {
			 var variable = '#'+$(domEle).attr('id');
			 
			 if(typeof $(variable).prop("files")[0] != 'undefined'){
				 
				if( $(domEle).attr('id').split('surveyImagePath_')[1] != undefined ){
				 	var variable_id = $(domEle).attr('id').split('surveyImagePath_')[1]
					//console.log('variable_id :::'+variable_id );
				 	variable_id = parseInt(variable_id);
				 	//console.log($(variable).parents('.answer_n').css('background-image').replace(/"/g, "").replace(/^url|[\(\)]/g, "").replace(/^data:image\/(png|jpeg);base64,/, ""));
				 	fd.append('crop_image'+variable_id, $(variable).parents('.answer_n').css('background-image').replace(/"/g, "").replace(/^url|[\(\)]/g, "").replace(/^data:image\/(png|jpeg);base64,/, ""));
				 	
					fd.append('file', $(variable).prop("files")[0]) 	 
				}else {
					var variable_id = $(domEle).attr('id').split('surveyImagePath')[1]
					//console.log('variable_id :::'+variable_id );
				 	variable_id = parseInt(variable_id);
				 	//console.log($('#img'+variable_id+'').attr('src').replace(/^data:image\/(png|jpeg);base64,/, ""));
				 	fd.append('crop_image'+variable_id, $('#img'+variable_id+'').attr('src'));
					fd.append('file', $(variable).prop("files")[0])
				 	console.log('file::::::::');
				 	console.log($(variable).prop("files")[0]);
				}//end if
				
			 }//end if
		}); 
			
			
		$('.progress_wrap').css('display','');
		//console.log(imageArray);
		//설문조사 유형, 양자택일형 : 1
		if(btn1Click==true){
			fd.append('surveyType', 1);
		}else if(btn2Click==true){	//설문조사 유형, 단수선택형 : 2
			fd.append('surveyType', 2);
		}else if(btn3Click==true){	//설문조사 유형, 복수선택형 : 3
			fd.append('surveyType', 3);
		
			console.log('answer_num::'+$('.select_type_answer_title').text());
			fd.append('answerNum', $('.select_type_answer_title').text());
			//return false;
		}else if(btn4Click==true){	//설문조사 유형, 순위형 : 4
			fd.append('surveyType', 4);
		}else if(btn5Click==true){	//설문조사 유형, 별점채점형 : 5
			fd.append('surveyType', 5);
		
			var evaluationItemCnt = $('input[name=evaluationItem]').size();
			console.log('evaluationItemCnt ::'+evaluationItemCnt);
			fd.append('evaluationItemCnt', evaluationItemCnt);
		}//if
		
		//설문조사 id 값
		fd.append('surveyId', getUrlParameter('surveyId'));
		//모든 text 필드 값 append
		fd.append('data', data);
		
		//partnerId 값
		var partnerId = getUrlParameter('partnerId');
		console.log('partnerId::'+partnerId);
		fd.append('partnerId', partnerId);
		
		//$('.second.circle').circleProgress({
			 // value: 1
		//}).on('circle-animation-progress', function(event, progress) {
		  //$(this).find('strong').html(parseInt(100 * progress) + '<i>%</i>');
  		//if(progress == 1){
		  $.ajax({
				url : '/upload/insertSurveySecondTitle',
				data : fd,
				type : 'POST',
				//dataType: 'json',
				processData : false,
				contentType : false,
				success : function(){
					$('.success_survey_wrap').css('display','');
					$('.additional_wrap').css('display','none');
					/* setInterval(function(){ location.reload(); }, 200); */
					
					/* alert('설문지가 저장되었습니다.'); */
					//팝업 초기화 
					//reloadFunc();
					/* location.reload(); */
				}//end //ccess
			});//end ajax
	}
	
	$('.go_list').click(function(){
		location.href="/upload/m_builder_list"
	})
	$('.add_survey').click(function(){
		location.reload();
	})
	$('.typeBtn').click(function(){
		$('#answer_type_click_count').val(1);
	})
	

})

</script>

<img src="" id="cropImage" style="width: 150px; height: 150px; display: none;">
<script src="/js/web/mobile/survey/assets/js/tether.min.js"></script>
<script src="/js/web/mobile/survey/assets/js/bootstrap.min.js"></script>
<script src="/js/web/mobile/survey/dist/cropper.js"></script>
<script src="/js/web/mobile/survey/js/main.js"></script>
<!--  Crop  -->
<div class="wrap" style="display: none; z-index:10;">    
	<div class="img-container" style="display: none;">
		<img src="" alt="">
	</div>

	<div class="img-preview preview-lg"></div><br><br><br><br><br><br><br><br><br>
	<a class="btn btn-primary" id="download" href="javascript:void(0);" download="cropped.jpg" style="display: none;">Download</a>
	<div class="container">
		<div class="row">
		<div class="col-md-9">
		<!-- <h3 class="page-header">Demo:</h3> -->

		</div>
		</div>
		<div class="row" id="actions">
		<div class="col-md-9 docs-buttons">
		<!-- <h3 class="page-header">Toolbar:</h3> -->


		<div class="btn-group">
		<button type="button" class="btn btn-primary" data-method="getCroppedCanvas">
		<span class="docs-tooltip" data-toggle="tooltip">
		확인
		</span>
		</button>

		<button type="button" class="btn btn-primary" id="cancel">
		<span class="docs-tooltip" data-toggle="tooltip">
		취소
		</span>
		</button>

		</div>
		<div class="btn-group btn-group-crop">

		</div>

		<!-- <div class="preview_200" style="width: 200px; height: 200px; background-color: gray"></div> -->
		<!-- Show the cropped image in modal -->
		<div class="modal fade docs-cropped" id="getCroppedCanvasModal" role="dialog" aria-hidden="true" aria-labelledby="getCroppedCanvasTitle" tabindex="-1">
		<div class="modal-dialog">
		<div class="modal-content">
		<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
		<h4 class="modal-title" id="getCroppedCanvasTitle">Cropped</h4>
		</div>
		<div class="modal-body"></div>
		<div class="modal-footer">
		<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>

		</div>
		</div>
		</div>
		</div><!-- /.modal -->



		</div><!-- /.docs-buttons -->

		<div class="col-md-3 docs-toggles">

		</div><!-- /.docs-toggles -->
		</div>
	</div>


	<img src="" id="cropImage" style="width: 150px; height: 150px; display: none;">
	<input type="hidden" id="answer_id_value" value="0">
	<div class="survey_container">

	</div>
</div>
<input type="hidden" id="clickCount" value="0">
<input type="hidden" id="secondSurveyTitle_hidden">
<!--  Crop  -->

<!-- progressbar -->
<div class="progress_wrap" style="display: none;">
	<div class="circles">
     	<div class="second circle">
      		<strong></strong>
    	</div>
  	</div>
</div>
<!-- <script src="/js/web/mobile/progress/circle-progress.js"></script>
<script type="text/javascript" src="/js/web/mobile/progress/progress.js"></script>
<link href="/js/web/mobile/progress/progress.css" rel="stylesheet"> -->
<!-- //progressbar -->

<!--(월)밤 11시 코딩 -->
<!-- <script src="/js/web/mobile/m_survey/m_survey.js"></script> -->
<!--(월)밤 11시 코딩 -->
<!-- 설문완료 후 신청하기/추가하기 선택화면 -->
<div class="success_survey_wrap">
	<div class="success_survey_header">
		<img src="/img/mobile/builder/survey/reg_survey/success_survey_wrap/survey_ok_topico.png" style="width: 25%; margin-left: 38%; margin-top: 18%;">	
		<img src="/img/mobile/builder/survey/reg_survey/success_survey_wrap/survey_toptit.png" style="width: 70%; margin-left: 15%; margin-top: 10%;">
	</div>
	<div class="success_survey_contents">
		<br>
		<img src="/img/mobile/builder/survey/reg_survey/success_survey_wrap/survey_topline.png" style="width: 70%; margin-left: 15%;">
		<br><br>
		<img src="/img/mobile/builder/survey/reg_survey/success_survey_wrap/apply_bt.png" style="width: 23%; float: left; margin-left: 20%;" class="go_list">	
		<img src="/img/mobile/builder/survey/reg_survey/success_survey_wrap/add_bt.png" style="width: 23%; float: left; margin-left: 13%;" class="add_survey">
	</div>
	<div class="success_survey_footer"></div>
</div>

<!-- 복수형 / 별점채점형 추가 화면 -->
<div class="additional_wrap" style="display: none;">
	<div class="additional_header"></div>
	<div class="additional_container">
	</div>
	<div class="additional_footer">
		<!-- <div class="modify_btn">수정</div>  --> <!-- 추후 추가 -->
		<div class="finish_btn">완료</div>
	</div>
</div>

<input type="hidden" id="answer_type_click_count" value="0">
<input type="hidden" id="answer_type" value=""> <!-- 응답유형 -->
</body>
</html>